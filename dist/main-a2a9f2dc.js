"use strict";function e(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}function t(e){if(e.__esModule)return e;var t=Object.defineProperty({},"__esModule",{value:!0});return Object.keys(e).forEach((i=>{var n=Object.getOwnPropertyDescriptor(e,i);Object.defineProperty(t,i,n.get?n:{enumerable:!0,get:()=>e[i]})})),t}function i(e){var t={exports:{}};return e(t,t.exports),t.exports}function n(e,t){for(var i=0;t.length>i;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function r(e,t,i){return t&&n(e.prototype,t),i&&n(e,i),e}function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){for(var i=0;t.length>i;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function a(e){if(null==si&&(si=li),!si.isDisposable(e))throw new TypeError("Arguments to CompositeDisposable.add must have a .dispose() method")}function l(e,t){for(var i=0;t.length>i;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function c(e,t,i){return t&&l(e.prototype,t),i&&l(e,i),e}function h(){var e={},t=0,i=0,n=0;return{add(r,s){s||(s=r,r=0),r>i?i=r:n>r&&(n=r),e[r]||(e[r]=[]),e[r].push(s),t++},process(){for(var t=n;i>=t;t++)for(var r=e[t],s=0;r.length>s;s++)(0,r[s])()},size:()=>t}}function d(e){return e._erd}function u(e){return Array.isArray(e)||void 0!==e.length}function p(e){if(Array.isArray(e))return e;var t=[];return Ti(e,(e=>{t.push(e)})),t}function m(e){return e&&1===e.nodeType}function g(e,t,i){var n=e[t];return null==n&&void 0!==i?i:n}function f(e,t){return t=null==t?e.length-1:+t,function(){for(var i=Math.max(arguments.length-t,0),n=Array(i),r=0;i>r;r++)n[r]=arguments[r+t];switch(t){case 0:return e.call(this,n);case 1:return e.call(this,arguments[0],n);case 2:return e.call(this,arguments[0],arguments[1],n)}var s=Array(t+1);for(r=0;t>r;r++)s[r]=arguments[r];return s[t]=n,e.apply(this,s)}}function v(e){var t=typeof e;return"function"===t||"object"===t&&!!e}function y(e){return null===e}function b(e){return void 0===e}function S(e){return!0===e||!1===e||"[object Boolean]"===_i.call(e)}function w(e){return!(!e||1!==e.nodeType)}function x(e){return t=>_i.call(t)==="[object "+e+"]"}function E(e,t){return null!=e&&Ri.call(e,t)}function C(e){return!Ki(e)&&Wi(e)&&!isNaN(parseFloat(e))}function T(e){return Ui(e)&&Fi(e)}function M(e){return()=>e}function k(e){return t=>{var i=e(t);return"number"==typeof i&&i>=0&&9007199254740991>=i}}function D(e){return t=>null==t?void 0:t[e]}function A(e,t){t=(e=>{for(var t={},i=e.length,n=0;i>n;++n)t[e[n]]=!0;return{contains(e){return t[e]},push(i){return t[i]=!0,e.push(i)}}})(t);var i=qi.length,n=e.constructor,r=rn(n)&&n.prototype||Di,s="constructor";for(E(e,s)&&!t.contains(s)&&t.push(s);i--;)(s=qi[i])in e&&e[s]!==r[s]&&!t.contains(s)&&t.push(s)}function L(e){if(!v(e))return[];if(Hi)return Hi(e);var t=[];for(var i in e)E(e,i)&&t.push(i);return Bi&&A(e,t),t}function O(e){return null==e||(un(e)&&(tn(e)||zi(e)||on(e))?0===e.length:0===L(e).length)}function _(e,t){var i=L(t),n=i.length;if(null==e)return!n;for(var r=Object(e),s=0;n>s;s++){var o=i[s];if(t[o]!==r[o]||!(o in r))return!1}return!0}function R(e){return e instanceof R?e:this instanceof R?void(this._wrapped=e):new R(e)}function P(e,t,i,n){if(e===t)return 0!==e||1/e==1/t;if(null==e||null==t)return!1;if(e!=e)return t!=t;var r=typeof e;return("function"===r||"object"===r||"object"==typeof t)&&I(e,t,i,n)}function I(e,t,i,n){e instanceof R&&(e=e._wrapped),t instanceof R&&(t=t._wrapped);var r=_i.call(e);if(r!==_i.call(t))return!1;switch(r){case"[object RegExp]":case"[object String]":return""+e==""+t;case"[object Number]":return+e!=+e?+t!=+t:0==+e?1/+e==1/t:+e==+t;case"[object Date]":case"[object Boolean]":return+e==+t;case"[object Symbol]":return Ai.valueOf.call(e)===Ai.valueOf.call(t);case"[object ArrayBuffer]":return I(new DataView(e),new DataView(t),i,n);case"[object DataView]":var s=an(e);if(s!==an(t))return!1;for(;s--;)if(e.getUint8(s)!==t.getUint8(s))return!1;return!0}if(hn(e))return I(new DataView(e.buffer),new DataView(t.buffer),i,n);var o="[object Array]"===r;if(!o){if("object"!=typeof e||"object"!=typeof t)return!1;var a=e.constructor,l=t.constructor;if(a!==l&&!(rn(a)&&a instanceof a&&rn(l)&&l instanceof l)&&"constructor"in e&&"constructor"in t)return!1}n=n||[];for(var c=(i=i||[]).length;c--;)if(i[c]===e)return n[c]===t;if(i.push(e),n.push(t),o){if((c=e.length)!==t.length)return!1;for(;c--;)if(!P(e[c],t[c],i,n))return!1}else{var h,d=L(e);if(c=d.length,L(t).length!==c)return!1;for(;c--;)if(!E(t,h=d[c])||!P(e[h],t[h],i,n))return!1}return i.pop(),n.pop(),!0}function H(e,t){return P(e,t)}function N(e){if(!v(e))return[];var t=[];for(var i in e)t.push(i);return Bi&&A(e,t),t}function j(e){for(var t=L(e),i=t.length,n=Array(i),r=0;i>r;r++)n[r]=e[t[r]];return n}function F(e){for(var t=L(e),i=t.length,n=Array(i),r=0;i>r;r++)n[r]=[t[r],e[t[r]]];return n}function W(e){for(var t={},i=L(e),n=0,r=i.length;r>n;n++)t[e[i[n]]]=i[n];return t}function B(e){var t=[];for(var i in e)rn(e[i])&&t.push(i);return t.sort()}function q(e,t){return function(i){var n=arguments.length;if(t&&(i=Object(i)),2>n||null==i)return i;for(var r=1;n>r;r++)for(var s=arguments[r],o=e(s),a=o.length,l=0;a>l;l++){var c=o[l];t&&void 0!==i[c]||(i[c]=s[c])}return i}}function z(e){if(!v(e))return{};if(Ni)return Ni(e);var t=()=>{};t.prototype=e;var i=new t;return t.prototype=null,i}function U(e,t){var i=z(e);return t&&mn(i,t),i}function V(e){return v(e)?tn(e)?e.slice():pn({},e):e}function $(e,t){return t(e),e}function Q(e,t){if(!tn(t))return E(e,t);for(var i=t.length,n=0;i>n;n++){var r=t[n];if(null==e||!Ri.call(e,r))return!1;e=e[r]}return!!i}function K(e){return e}function Z(e){return e=mn({},e),t=>_(t,e)}function G(e,t){for(var i=t.length,n=0;i>n;n++){if(null==e)return;e=e[t[n]]}return i?e:void 0}function Y(e){return tn(e)?t=>G(t,e):D(e)}function X(e,t,i){if(void 0===t)return e;switch(null==i?3:i){case 1:return i=>e.call(t,i);case 3:return(i,n,r)=>e.call(t,i,n,r);case 4:return(i,n,r,s)=>e.call(t,i,n,r,s)}return function(){return e.apply(t,arguments)}}function J(e,t,i){return null==e?K:rn(e)?X(e,t,i):v(e)&&!tn(e)?Z(e):Y(e)}function ee(e,t){return J(e,t,1/0)}function te(e,t,i){return R.iteratee!==ee?R.iteratee(e,t):J(e,t,i)}function ie(e,t,i){t=te(t,i);for(var n=L(e),r=n.length,s={},o=0;r>o;o++){var a=n[o];s[a]=t(e[a],a,e)}return s}function ne(){}function re(e){return null==e?()=>{}:t=>tn(t)?G(e,t):e[t]}function se(e,t,i){var n=Array(Math.max(0,e));t=X(t,i,1);for(var r=0;e>r;r++)n[r]=t(r);return n}function oe(e,t){return null==t&&(t=e,e=0),e+Math.floor(Math.random()*(t-e+1))}function ae(e){var t=t=>e[t],i="(?:"+L(e).join("|")+")",n=RegExp(i),r=RegExp(i,"g");return e=>n.test(e=null==e?"":""+e)?e.replace(r,t):e}function le(e){return"\\"+wn[e]}function ce(e,t,i){!t&&i&&(t=i),t=gn({},t,R.templateSettings);var n,r=RegExp([(t.escape||/(.)^/).source,(t.interpolate||/(.)^/).source,(t.evaluate||/(.)^/).source].join("|")+"|$","g"),s=0,o="__p+='";e.replace(r,((t,i,n,r,a)=>(o+=e.slice(s,a).replace(/\\|'|\r|\n|\u2028|\u2029/g,le),s=a+t.length,i?o+="'+\n((__t=("+i+"))==null?'':_.escape(__t))+\n'":n?o+="'+\n((__t=("+n+"))==null?'':__t)+\n'":r&&(o+="';\n"+r+"\n__p+='"),t))),o+="';\n",t.variable||(o="with(obj||{}){\n"+o+"}\n"),o="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+o+"return __p;\n";try{n=Function(t.variable||"obj","_",o)}catch(e){throw e.source=o,e}var a=function(e){return n.call(this,e,R)};return a.source="function("+(t.variable||"obj")+"){\n"+o+"}",a}function he(e,t,i){tn(t)||(t=[t]);var n=t.length;if(!n)return rn(i)?i.call(e):i;for(var r=0;n>r;r++){var s=null==e?void 0:e[t[r]];void 0===s&&(s=i,r=n),e=rn(s)?s.call(e):s}return e}function de(e){var t=++xn+"";return e?e+t:t}function ue(e){var t=R(e);return t._chain=!0,t}function pe(e,t,i,n,r){if(!(n instanceof t))return e.apply(i,r);var s=z(e.prototype),o=e.apply(s,r);return v(o)?o:s}function me(e,t,i,n){if(n=n||[],t||0===t){if(0>=t)return n.concat(e)}else t=1/0;for(var r=n.length,s=0,o=dn(e);o>s;s++){var a=e[s];if(un(a)&&(tn(a)||on(a)))if(t>1)me(a,t-1,i,n),r=n.length;else for(var l=0,c=a.length;c>l;)n[r++]=a[l++];else i||(n[r++]=a)}return n}function ge(e,t){var i=function(n){var r=i.cache,s=""+(t?t.apply(this,arguments):n);return E(r,s)||(r[s]=e.apply(this,arguments)),r[s]};return i.cache={},i}function fe(e,t,i){var n,r,s,o,a=0;i||(i={});var l=()=>{a=!1===i.leading?0:fn(),n=null,o=e.apply(r,s),n||(r=s=null)},c=function(){var c=fn();a||!1!==i.leading||(a=c);var h=t-(c-a);return r=this,s=arguments,0>=h||h>t?(n&&(clearTimeout(n),n=null),a=c,o=e.apply(r,s),n||(r=s=null)):n||!1===i.trailing||(n=setTimeout(l,h)),o};return c.cancel=()=>{clearTimeout(n),a=0,n=r=s=null},c}function ve(e,t,i){var n,r,s=(t,i)=>{n=null,i&&(r=e.apply(t,i))},o=f((function(o){if(n&&clearTimeout(n),i){var a=!n;n=setTimeout(s,t),a&&(r=e.apply(this,o))}else n=Mn(s,t,this,o);return r}));return o.cancel=()=>{clearTimeout(n),n=null},o}function ye(e,t){return En(t,e)}function be(e){return function(){return!e.apply(this,arguments)}}function Se(){var e=arguments,t=e.length-1;return function(){for(var i=t,n=e[t].apply(this,arguments);i--;)n=e[i].call(this,n);return n}}function we(e,t){return function(){if(1>--e)return t.apply(this,arguments)}}function xe(e,t){var i;return function(){return--e>0&&(i=t.apply(this,arguments)),e>1||(t=null),i}}function Ee(e,t,i){t=te(t,i);for(var n,r=L(e),s=0,o=r.length;o>s;s++)if(t(e[n=r[s]],n,e))return n}function Ce(e){return(t,i,n)=>{i=te(i,n);for(var r=dn(t),s=e>0?0:r-1;s>=0&&r>s;s+=e)if(i(t[s],s,t))return s;return-1}}function Te(e,t,i,n){for(var r=(i=te(i,n,1))(t),s=0,o=dn(e);o>s;){var a=Math.floor((s+o)/2);i(e[a])<r?s=a+1:o=a}return s}function Me(e,t,i){return(n,r,s)=>{var o=0,a=dn(n);if("number"==typeof s)e>0?o=0>s?Math.max(s+a,o):s:a=0>s?s+a+1:Math.min(s+1,a);else if(i&&s&&a)return n[s=i(n,r)]===r?s:-1;if(r!=r)return 0>(s=t(Oi.call(n,o,a),T))?-1:s+o;for(s=e>0?o:a-1;s>=0&&a>s;s+=e)if(n[s]===r)return s;return-1}}function ke(e,t,i){var n=(un(e)?An:Ee)(e,t,i);if(void 0!==n&&-1!==n)return e[n]}function De(e,t){return ke(e,Z(t))}function Ae(e,t,i){var n,r;if(t=X(t,i),un(e))for(n=0,r=e.length;r>n;n++)t(e[n],n,e);else{var s=L(e);for(n=0,r=s.length;r>n;n++)t(e[s[n]],s[n],e)}return e}function Le(e,t,i){t=te(t,i);for(var n=!un(e)&&L(e),r=(n||e).length,s=Array(r),o=0;r>o;o++){var a=n?n[o]:o;s[o]=t(e[a],a,e)}return s}function Oe(e){var t=(t,i,n,r)=>{var s=!un(t)&&L(t),o=(s||t).length,a=e>0?0:o-1;for(r||(n=t[s?s[a]:a],a+=e);a>=0&&o>a;a+=e){var l=s?s[a]:a;n=i(n,t[l],l,t)}return n};return function(e,i,n,r){var s=arguments.length>=3;return t(e,X(i,r,4),n,s)}}function _e(e,t,i){var n=[];return t=te(t,i),Ae(e,((e,i,r)=>{t(e,i,r)&&n.push(e)})),n}function Re(e,t,i){return _e(e,be(te(t)),i)}function Pe(e,t,i){t=te(t,i);for(var n=!un(e)&&L(e),r=(n||e).length,s=0;r>s;s++){var o=n?n[s]:s;if(!t(e[o],o,e))return!1}return!0}function Ie(e,t,i){t=te(t,i);for(var n=!un(e)&&L(e),r=(n||e).length,s=0;r>s;s++){var o=n?n[s]:s;if(t(e[o],o,e))return!0}return!1}function He(e,t,i,n){return un(e)||(e=j(e)),("number"!=typeof i||n)&&(i=0),On(e,t,i)>=0}function Ne(e,t){return Le(e,Y(t))}function je(e,t){return _e(e,Z(t))}function Fe(e,t,i){var n,r,s=-1/0,o=-1/0;if(null==t||"number"==typeof t&&"object"!=typeof e[0]&&null!=e)for(var a=0,l=(e=un(e)?e:j(e)).length;l>a;a++)null!=(n=e[a])&&n>s&&(s=n);else t=te(t,i),Ae(e,((e,i,n)=>{((r=t(e,i,n))>o||r===-1/0&&s===-1/0)&&(s=e,o=r)}));return s}function We(e,t,i){var n,r,s=1/0,o=1/0;if(null==t||"number"==typeof t&&"object"!=typeof e[0]&&null!=e)for(var a=0,l=(e=un(e)?e:j(e)).length;l>a;a++)null!=(n=e[a])&&s>n&&(s=n);else t=te(t,i),Ae(e,((e,i,n)=>{r=t(e,i,n),(o>r||r===1/0&&s===1/0)&&(s=e,o=r)}));return s}function Be(e,t,i){if(null==t||i)return un(e)||(e=j(e)),e[oe(e.length-1)];var n=un(e)?V(e):j(e),r=dn(n);t=Math.max(Math.min(t,r),0);for(var s=r-1,o=0;t>o;o++){var a=oe(o,s),l=n[o];n[o]=n[a],n[a]=l}return n.slice(0,t)}function qe(e){return Be(e,1/0)}function ze(e,t,i){var n=0;return t=te(t,i),Ne(Le(e,((e,i,r)=>({value:e,index:n++,criteria:t(e,i,r)}))).sort(((e,t)=>{var i=e.criteria,n=t.criteria;if(i!==n){if(i>n||void 0===i)return 1;if(n>i||void 0===n)return-1}return e.index-t.index})),"value")}function Ue(e,t){return(i,n,r)=>{var s=t?[[],[]]:{};return n=te(n,r),Ae(i,((t,r)=>{var o=n(t,r,i);e(s,t,o)})),s}}function Ve(e){return e?tn(e)?Oi.call(e):zi(e)?e.match(/[^\ud800-\udfff]|[\ud800-\udbff][\udc00-\udfff]|[\ud800-\udfff]/g):un(e)?Le(e,K):j(e):[]}function $e(e){return null==e?0:un(e)?e.length:L(e).length}function Qe(e,t,i){return t in i}function Ke(e,t,i){return Oi.call(e,0,Math.max(0,e.length-(null==t||i?1:t)))}function Ze(e,t,i){return null==e||1>e.length?null==t||i?void 0:[]:null==t||i?e[0]:Ke(e,e.length-t)}function Ge(e,t,i){return Oi.call(e,null==t||i?1:t)}function Ye(e,t,i){return null==e||1>e.length?null==t||i?void 0:[]:null==t||i?e[e.length-1]:Ge(e,Math.max(0,e.length-t))}function Xe(e){return _e(e,Boolean)}function Je(e,t){return me(e,t,!1)}function et(e,t,i,n){S(t)||(n=i,i=t,t=!1),null!=i&&(i=te(i,n));for(var r=[],s=[],o=0,a=dn(e);a>o;o++){var l=e[o],c=i?i(l,o,e):l;t&&!i?(o&&s===c||r.push(l),s=c):i?He(s,c)||(s.push(c),r.push(l)):He(r,l)||r.push(l)}return r}function tt(e){for(var t=[],i=arguments.length,n=0,r=dn(e);r>n;n++){var s=e[n];if(!He(t,s)){var o;for(o=1;i>o&&He(arguments[o],s);o++);o===i&&t.push(s)}}return t}function it(e){for(var t=e&&Fe(e,dn).length||0,i=Array(t),n=0;t>n;n++)i[n]=Ne(e,n);return i}function nt(e,t){for(var i={},n=0,r=dn(e);r>n;n++)t?i[e[n]]=t[n]:i[e[n][0]]=e[n][1];return i}function rt(e,t,i){null==t&&(t=e||0,e=0),i||(i=e>t?-1:1);for(var n=Math.max(Math.ceil((t-e)/i),0),r=Array(n),s=0;n>s;s++,e+=i)r[s]=e;return r}function st(e,t){if(null==t||1>t)return[];for(var i=[],n=0,r=e.length;r>n;)i.push(Oi.call(e,n,n+=t));return i}function ot(e,t){return e._chain?R(t).chain():t}function at(e){return Ae(B(e),(function(t){var i=R[t]=e[t];R.prototype[t]=function(){var e=[this._wrapped];return Li.apply(e,arguments),ot(this,i.apply(R,e))}})),R}function lt(e,t,i,n,r,s,o,a){if(e.fillStyle=i,a){const i=t.length*s;return e.fillRect(n,r,i,o),n+i}{let i=0;for(let a=0,l=t.length;l>a;a++)" "===t[a]?(i>0&&e.fillRect(n-i*s,r,i*s,o),i=0):i++,n+=s;return i>0&&e.fillRect(n-i*s,r,i*s,o),n}}function ct(e,t,i,n,r,s,o,a,l,c,h,d,u,p){if(e>t)return;let m,g,f=i*n-n;t=Math.min(t,c);for(let i=e;t>i;i++){const e=l.tokensForScreenRow(i),t=Math.min(e.length,p);for(let l=0;t>l;l++){const t=e[l],c=t.text.replace(h," "),p=t.scopes;m!==i&&(g=0,f+=n,m=i,a.clearRect(g,f,o,n)),g>o||(Xn.test(c)?g+=c.length*s:g=lt(a,c,d(p),g,f,s,r,u))}}a.fill()}function ht(e,t,i){const n=e.getMarker().getScreenRange(),r=n.end.row-n.start.row;if(t.context.fillStyle=i,0===r)t.context.fillRect(n.start.column*t.charWidth,t.yRow,(n.end.column-n.start.column)*t.charWidth,t.lineHeight);else if(t.screenRow===n.start.row){const e=n.start.column*t.charWidth;t.context.fillRect(e,t.yRow,t.canvasWidth-e,t.lineHeight)}else t.context.fillRect(0,t.yRow,t.screenRow===n.end.row?n.end.column*t.charWidth:t.canvasWidth,t.lineHeight)}function dt(e,t,i,n,r){let s=[];i.context.clearRect(0,i.yRow,i.canvasWidth,i.lineHeight);for(const i in n)s=s.concat(null!=t[i]&&t[i][e]||[]);if(s.sort(((e,t)=>(i.orders[e.properties.plugin]||0)-(i.orders[t.properties.plugin]||0))),null!=s?s.length:void 0)for(let e=0,t=s.length;t>e;e++){const t=s[e],o=n[t.properties.type];if(Gn){undefined[o.name.split("$").pop().replace("Lambda","")](t,i,ft(t,r))}else o(t,i,ft(t,r))}}function ut(e,t,i,n,r,s,o){if(t>=e){for(let a=e;t>=a;a++)n.row=i+(a-e),n.yRow=n.row*r,n.screenRow=a,dt(a,o,n,er,s);n.context.fill()}}function pt(e,t,i,n,r,s,o){if(t>=e){for(let a=e;t>=a;a++)n.row=i+(a-e),n.yRow=n.row*r,n.screenRow=a,dt(a,o,n,Jn,s);n.context.fill()}}function mt(e,t){return gt(exports.domStylesReader.retrieveStyleFromDom([".editor"],"color",e,!0),t)}function gt(e,t){return`rgba(${e.slice(4,-1)}, ${t})`}function ft(e,t){const i=e.getProperties();if(i.color)return i.color;if(i.scope){const e=i.scope.split(/\s+/);return exports.domStylesReader.retrieveStyleFromDom(e,"background-color",t,!0)}return mt(t)}function vt(e,t,i,n,r){if(null==n&&null==r)return[];let s=[{start:n,end:r,offscreenRow:0}];for(let e=0,t=i.length;t>e;e++){const t=i[e],n=[];for(let e=0,i=s.length;i>e;e++){const i=s[e];i.start>t.end&&0!==t.screenDelta?n.push({start:i.start+t.screenDelta,end:i.end+t.screenDelta,offscreenRow:i.offscreenRow}):i.start>t.end||t.start>i.end?n.push(i):(t.start>i.start&&n.push({start:i.start,end:t.start-1,offscreenRow:i.offscreenRow}),i.end>t.end&&n.push(0!==t.bufferDelta||0!==t.screenDelta?{start:t.end+t.screenDelta+1,end:i.end+t.screenDelta,offscreenRow:i.offscreenRow+t.end+1-i.start}:{start:t.end+1,end:i.end,offscreenRow:i.offscreenRow+t.end+1-i.start}))}s=n}return((e,t,i)=>{let n=0;for(;e.length>n;){const r=e[n];t>r.start&&(r.offscreenRow+=t-r.start,r.start=t),r.end>i&&(r.end=i),r.end>r.start||e.splice(n--,1),n++}return e.sort(((e,t)=>e.offscreenRow-t.offscreenRow))})(s,e,t)}function yt(e,...t){t.forEach((t=>{var i,n;i=e,Object.getOwnPropertyNames(n=t).forEach((e=>{0>["length","name","arguments","caller","prototype","includeInto"].indexOf(e)&&Object.defineProperty(i,e,Object.getOwnPropertyDescriptor(n,e))})),Object.getOwnPropertyNames(n.prototype).forEach((e=>{"constructor"!==e&&Object.defineProperty(i.prototype,e,Object.getOwnPropertyDescriptor(n.prototype,e))}))}))}function bt(e,t){return bi.registerOrUpdateElement(t,{class:e})}function St(e){nr&&(nr.textContent=`\n    atom-text-editor[with-minimap].editor > div,\n    atom-text-editor[with-minimap] > div {\n      margin-left: ${e}px;\n    }\n    `)}function wt(e){return{x:e.pageX,y:e.pageY,isLeftMouse:0===e.button,isMiddleMouse:1===e.button}}function xt(e){const t=e.changedTouches[0];return{x:t.pageX,y:t.pageY,isLeftMouse:!0,isMiddleMouse:!1}}function Et(e,t){if(!e)return;let i="";for(const e in t)i+=`${e}: ${t[e]}; `;e.style.cssText=i}function Ct(e=0,t=0,i=!1){return i?`translate3d(${e}px, ${t}px, 0)`:`translate(${e}px, ${t}px)`}function Tt(e=0,t=e,i=!1){return i?`scale3d(${e}, ${t}, 1)`:`scale(${e}, ${t})`}function Mt({from:e,to:t,duration:i,step:n}){const r=kt();let s;const o=()=>{const a=kt()-r;s=0===i?1:a/i,s>1&&(s=1);const l=(e=>.5-Math.cos(e*Math.PI)/2)(s);n(e+(t-e)*l,l),1>s&&requestAnimationFrame(o)};o()}function kt(){return new Date}function Dt(e,t){pr[e]=t,mr[e]=new ti.CompositeDisposable,Er.emit("did-add-plugin",{name:e,plugin:t}),atom.config.get("minimap.displayPluginsControls")&&((e,t)=>{const i="minimap.plugins."+e,n=`minimap.plugins.${e}DecorationsZIndex`,r=jt();r.plugins.properties[e]={type:"boolean",title:e,description:`Whether the ${e} plugin is activated and displayed in the Minimap.`,default:!0},r.plugins.properties[e+"DecorationsZIndex"]={type:"integer",title:e+" decorations order",description:`The relative order of the ${e} plugin's decorations in the layer into which they are drawn. Note that this order only apply inside a layer, so highlight-over decorations will always be displayed above line decorations as they are rendered in different layers.`,default:0},void 0===atom.config.get(i)&&atom.config.set(i,!0),void 0===atom.config.get(n)&&atom.config.set(n,0),mr[e].add(atom.config.observe(i,(()=>{_t(e)}))),mr[e].add(atom.config.observe(n,(i=>{It(e),Er.emit("did-change-plugin-order",{name:e,plugin:t,order:i})}))),mr[e].add(atom.commands.add("atom-workspace",{["minimap:toggle-"+e](){Lt(e)}})),It(e)})(e,t),_t(e)}function At(e){const t=pr[e];atom.config.get("minimap.displayPluginsControls")&&(e=>{mr[e].dispose(),delete mr[e],delete jt().plugins.properties[e]})(e),delete pr[e],Er.emit("did-remove-plugin",{name:e,plugin:t})}function Lt(e,t){const i="minimap.plugins."+e;null!=t?atom.config.set(i,t):atom.config.set(i,!atom.config.get(i)),_t(e)}function Ot(){for(const[e,t]of function*(){for(const e in pr)yield[e,pr[e]]}())t.deactivatePlugin(),Er.emit("did-deactivate-plugin",{name:e,plugin:t})}function _t(e){const t=pr[e],i=t.isActive(),n=atom.config.get("minimap.plugins."+e);atom.config.get("minimap.displayPluginsControls")?n&&!i?Rt(e,t):i&&!n&&Pt(e,t):i?i&&Pt(e,t):Rt(e,t)}function Rt(e,t){const i={name:e,plugin:t};t.activatePlugin(),Er.emit("did-activate-plugin",i)}function Pt(e,t){const i={name:e,plugin:t};t.deactivatePlugin(),Er.emit("did-deactivate-plugin",i)}function It(e){gr[e]=atom.config.get(`minimap.plugins.${e}DecorationsZIndex`)}function Ht(){return gr}function Nt(e){if(e instanceof dr){const t=new rr;return t.setModel(e),t}}function jt(){return ur||atom.packages.getLoadedPackage("minimap").metadata.configSchema}function Ft(){var e;yr&&(br?(br=!1,Sr&&Sr.forEach(((e,t)=>{e.destroy(),Sr.delete(t)})),wr.dispose()):(br=!0,wr.add(atom.workspace.observeTextEditors((e=>{const t=Yt(e),i=atom.views.getView(t);Er.emit("did-create-minimap",t),i.attach()})),atom.themes.onDidChangeActiveThemes((()=>{exports.domStylesReader.invalidateDOMStylesCache(),Sr.forEach((e=>{atom.views.getView(e).requestForcedUpdate()}))})),(e="core.useTreeSitterParsers",atom.config.observe(e,(t=>{if(!0!==t){const t="Minimap."+e,i=new Date,n=window.localStorage.getItem(t);let r=null;if(n&&(r=new Date(Date.parse(n)).getDay()),!r||"number"==typeof r&&r-i.getDay()>=1){window.localStorage.setItem(t,i);const n=atom.notifications.addWarning("Tree-sitter is off (Low Performance Warning).",{description:"You should turn on Atom's tree-sitter parser to experience the best performance Minimap and Atom is deisgned for.\n    Keeping tree-sitter parser off results in sluggish scrolling and lags in the text editor.",dismissable:!0,buttons:[{text:"Set to true and restart Atom",onDidClick(){atom.config.set(e,!0),n.dismiss(),window.localStorage.removeItem(t),setTimeout((()=>{atom.reload()}),1500)}}]})}}}))))),exports.domStylesReader.invalidateDOMStylesCache())}async function Wt(e){const{default:t}=await Promise.resolve().then((()=>require("./minimap-plugin-generator-element-2c9b5763.js"))),i=new t;i.template=e,i.attach()}function Bt(e){return Er.on("did-activate",e)}function qt(e){return Er.on("did-deactivate",e)}function zt(e){return Er.on("did-create-minimap",e)}function Ut(e){return Er.on("did-add-plugin",e)}function Vt(e){return Er.on("did-remove-plugin",e)}function $t(e){return Er.on("did-activate-plugin",e)}function Qt(e){return Er.on("did-deactivate-plugin",e)}function Kt(e){return Er.on("did-change-plugin-order",e)}function Zt(){return dr}function Gt(e){if(e)return Yt(e.getModel())}function Yt(e){if(!e)return;if(!Sr)return;let t=Sr.get(e);if(!t){t=new dr({textEditor:e}),Sr.set(e,t);const i=e.onDidDestroy((()=>{Sr&&Sr.delete(e),i.dispose()}))}return t}function Xt(e){if(e)return new dr({textEditor:e,standAlone:!0})}function Jt(){return Yt(atom.workspace.getActiveTextEditor())}function ei(e){if(e)return Sr&&Sr.forEach((t=>{e(t)})),zt((t=>{e(t)}))}const ti=require("atom"),ii=require("path"),ni=e(ti),ri=e(ii);var si,oi="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},ai=i((function(e){e.exports=function(){function e(e,t,i){this.message=e,this.fileName=t,this.lineNumber=i,this.callCount=0,this.stackCount=0,this.stacks={},this.stackCallCounts={}}return e.getFunctionNameFromCallsite=e=>{},e.deserialize=t=>{var i,n,r,s,o;for(r=t.stacks,i=new e(t.message,t.fileName,t.lineNumber),s=0,o=r.length;o>s;s++)i.addStack(n=r[s],n.metadata);return i},e.prototype.getFunctionNameFromCallsite=e=>{var t,i,n;return null!=e.functionName?e.functionName:e.isToplevel()?null!=(t=e.getFunctionName())?t:"<unknown>":e.isConstructor()?"new "+e.getFunctionName():e.getMethodName()&&!e.getFunctionName()?e.getMethodName():e.getTypeName()+"."+(null!=(i=null!=(n=e.getMethodName())?n:e.getFunctionName())?i:"<anonymous>")},e.prototype.getLocationFromCallsite=function(e){return null==e?"unknown":null!=e.location?e.location:e.isNative()?"native":e.isEval()?"eval at "+this.getLocationFromCallsite(e.getEvalOrigin()):e.getFileName()+":"+e.getLineNumber()+":"+e.getColumnNumber()},e.prototype.getFileNameFromCallSite=e=>{var t;return null!=(t=e.fileName)?t:e.getFileName()},e.prototype.getOriginName=function(){return this.originName},e.prototype.getMessage=function(){return this.message},e.prototype.getStacks=function(){var e,t,i,n,r;for(e in i=[],r=this.stacks)(t=this.parseStack(n=r[e])).callCount=this.stackCallCounts[e],t.metadata=n.metadata,i.push(t);return i},e.prototype.getStackCount=function(){return this.stackCount},e.prototype.getCallCount=function(){return this.callCount},e.prototype.addStack=function(e,t){var i,n,r;return null==this.originName&&(this.originName=this.getFunctionNameFromCallsite(e[0])),null==this.fileName&&(this.fileName=this.getFileNameFromCallSite(e[0])),null==this.lineNumber&&(this.lineNumber="function"==typeof(n=e[0]).getLineNumber?n.getLineNumber():void 0),this.callCount++,e.metadata=t,i=this.getLocationFromCallsite(e[1]),null==this.stacks[i]&&(this.stacks[i]=e,this.stackCount++),null==(r=this.stackCallCounts)[i]&&(r[i]=0),this.stackCallCounts[i]++},e.prototype.parseStack=function(e){return e.map((t=this,e=>({functionName:t.getFunctionNameFromCallsite(e),location:t.getLocationFromCallsite(e),fileName:t.getFileNameFromCallSite(e)})));var t},e.prototype.serialize=function(){return{message:this.getMessage(),lineNumber:this.lineNumber,fileName:this.fileName,stacks:this.getStacks()}},e}()})),li=function(){function e(t){((e,t)=>{if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")})(this,e),this.disposed=!1,this.disposalAction=t}return r(e,null,[{key:"isDisposable",value:e=>"function"==typeof(null!=e?e.dispose:void 0)}]),r(e,[{key:"dispose",value(){this.disposed||(this.disposed=!0,"function"==typeof this.disposalAction&&this.disposalAction(),this.disposalAction=null)}}]),e}(),ci=function(){function e(){s(this,e),this.disposed=!1,this.disposables=new Set;var t=!0,i=!1,n=void 0;try{for(var r,o=arguments[Symbol.iterator]();!(t=(r=o.next()).done);t=!0){var a=r.value;this.add(a)}}catch(e){i=!0,n=e}finally{try{t||null==o.return||o.return()}finally{if(i)throw n}}}var t,i;return t=e,(i=[{key:"dispose",value(){this.disposed||(this.disposed=!0,this.disposables.forEach((e=>e.dispose())),this.disposables=null)}},{key:"add",value(){if(!this.disposed){var e=!0,t=!1,i=void 0;try{for(var n,r=arguments[Symbol.iterator]();!(e=(n=r.next()).done);e=!0){var s=n.value;a(s),this.disposables.add(s)}}catch(e){t=!0,i=e}finally{try{e||null==r.return||r.return()}finally{if(t)throw i}}}}},{key:"remove",value(e){this.disposed||this.disposables.delete(e)}},{key:"delete",value(e){this.remove(e)}},{key:"clear",value(){this.disposed||this.disposables.clear()}}])&&o(t.prototype,i),e}(),hi=function(){function e(){((e,t)=>{if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")})(this,e),this.disposed=!1,this.clear()}return c(e,null,[{key:"onEventHandlerException",value(e){var t=this;return 0===this.exceptionHandlers.length&&(this.dispatch=this.exceptionHandlingDispatch),this.exceptionHandlers.push(e),new li((()=>{if(t.exceptionHandlers.splice(t.exceptionHandlers.indexOf(e),1),0===t.exceptionHandlers.length)return t.dispatch=t.simpleDispatch}))}},{key:"simpleDispatch",value:(e,t)=>e(t)},{key:"exceptionHandlingDispatch",value(e,t){try{return e(t)}catch(e){return this.exceptionHandlers.map((t=>t(e)))}}}]),c(e,[{key:"clear",value(){null!=this.subscriptions&&this.subscriptions.dispose(),this.subscriptions=new ci,this.handlersByEventName={}}},{key:"dispose",value(){this.subscriptions.dispose(),this.handlersByEventName=null,this.disposed=!0}},{key:"on",value(e,t,i){var n=this;if(null==i&&(i=!1),this.disposed)throw Error("Emitter has been disposed");if("function"!=typeof t)throw Error("Handler must be a function");this.handlersByEventName[e]?i?this.handlersByEventName[e].unshift(t):this.handlersByEventName[e].push(t):this.handlersByEventName[e]=[t];var r=new li((()=>(n.subscriptions.remove(r),n.off(e,t))));return this.subscriptions.add(r),r}},{key:"once",value(e,t,i){null==i&&(i=!1);var n=this.on(e,(e=>(n.dispose(),t(e))),i);return n}},{key:"preempt",value(e,t){return this.on(e,t,!0)}},{key:"off",value(e,t){if(!this.disposed){var i=this.handlersByEventName[e];if(i){var n=i.indexOf(t);0>n||i.splice(n,1),0===i.length&&delete this.handlersByEventName[e]}}}},{key:"emit",value(e,t){var i=this.handlersByEventName&&this.handlersByEventName[e];if(i)for(var n=i.slice(),r=0;n.length>r;r++)this.constructor.dispatch(n[r],t)}},{key:"emitAsync",value(e,t){var i=this,n=this.handlersByEventName&&this.handlersByEventName[e];if(n){var r=n.map((e=>i.constructor.dispatch(e,t)));return Promise.all(r).then((()=>{}))}return Promise.resolve()}},{key:"getEventNames",value(){return Object.keys(this.handlersByEventName)}},{key:"listenerCountForEventName",value(e){var t=this.handlersByEventName[e];return null==t?0:t.length}},{key:"getTotalListenerCount",value(){for(var e=0,t=Object.keys(this.handlersByEventName),i=0;t.length>i;i++)e+=this.handlersByEventName[t[i]].length;return e}}]),e}();hi.dispatch=hi.simpleDispatch,hi.exceptionHandlers=[];var di={Emitter:hi,Disposable:li,CompositeDisposable:ci},ui=i((function(e){!function(){var t,i,n;t=ai,null==oi.__grim__&&(n=oi.__grim__={deprecations:{},emitter:new(0,di.Emitter),includeDeprecatedAPIs:!0,getDeprecations(){var e,t,i,r,s,o,a;for(r in e=[],a=n.deprecations)for(s in t=a[r])for(o in i=t[s])e.push(i[o]);return e},getDeprecationsLength(){return this.getDeprecations().length},clearDeprecations(){n.deprecations={}},logDeprecations(){var e,t,i,n;for((t=this.getDeprecations()).sort(((e,t)=>t.getCallCount()-e.getCallCount())),console.warn("\nCalls to deprecated functions\n-----------------------------"),i=0,n=t.length;n>i;i++)console.warn("("+(e=t[i]).getCallCount()+") "+e.getOriginName()+" : "+e.getMessage(),e)},deprecate(e,r){var s,o,a,l,c,h,d,u,p,m,g,f,v;h=Error.stackTraceLimit;try{Error.stackTraceLimit=7,u=(u=null!=(f="function"==typeof(a=Error()).getRawStack?a.getRawStack():void 0)?f:i(a)).slice(1)}finally{Error.stackTraceLimit=h}l=(o=u[0]).getFileName(),c=o.getLineNumber(),d=null!=(v=null!=r?r.packageName:void 0)?v:"",null==(p=n.deprecations)[l]&&(p[l]={}),null==(m=n.deprecations[l])[c]&&(m[c]={}),null==(g=n.deprecations[l][c])[d]&&(g[d]=new t(e)),(s=n.deprecations[l][c][d]).addStack(u,r),n.emitter.emit("updated",s)},addSerializedDeprecation(e){var i,r,s,o,a,l,c,h,d,u,p,m,g,f,v;for(o=(i=t.deserialize(e)).getMessage(),r=i.fileName,s=i.lineNumber,a=null!=(g=null!=(f=(c=i.getStacks())[0])&&null!=(v=f.metadata)?v.packageName:void 0)?g:"",null==(h=n.deprecations)[r]&&(h[r]={}),null==(d=n.deprecations[r])[s]&&(d[s]={}),null==(u=n.deprecations[r][s])[a]&&(u[a]=new t(o,r,s)),i=n.deprecations[r][s][a],p=0,m=c.length;m>p;p++)i.addStack(l=c[p],l.metadata);n.emitter.emit("updated",i)},on:(e,t)=>n.emitter.on(e,t)}),i=e=>{var t,n;return t=Error.prepareStackTrace,Error.prepareStackTrace=(e,t)=>t,Error.captureStackTrace(e,i),n=e.stack,Error.prepareStackTrace=t,n},e.exports=oi.__grim__}()})),pi=i((function(e){var t,i,n,r;({deprecate:r}=ui),null!=oi.__CUSTOM_HTML_ELEMENTS_CLASSES__?(oi.__ATOM_UTILS_CUSTOM_ELEMENT_CLASSES__=oi.__CUSTOM_HTML_ELEMENTS_CLASSES__,delete oi.__CUSTOM_HTML_ELEMENTS_CLASSES__):null==oi.__ATOM_UTILS_CUSTOM_ELEMENT_CLASSES__&&(oi.__ATOM_UTILS_CUSTOM_ELEMENT_CLASSES__={}),t=["createdCallback","attachedCallback","detachedCallback","attributeChangedCallback"],n=function(e,i){return t.forEach((function(t){return Object.defineProperty(e,t,{value(){var e;return null!=(e=this["__"+t])?e.apply(this,arguments):void 0},writable:!0,enumerable:!0,configurable:!0})})),Object.getOwnPropertyNames(i).forEach((n=>{var r;if("constructor"!==n)return r=Object.getOwnPropertyDescriptor(i,n),t.indexOf(n)>-1?Object.defineProperty(e,"__"+n,r):Object.defineProperty(e,n,r)}))},i=(e,t)=>Object.getOwnPropertyNames(t).forEach((i=>{if("length"!==i&&"name"!==i&&"arguments"!==i&&"caller"!==i&&"prototype"!==i)return Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(t,i))})),e.exports=(e,t)=>{var s,o,a,l,c;return({class:a}=t),(l=null!=a?a.prototype:null!=(c=t.prototype)?c:t)===t&&r("Using the prototype as the second argument is deprecated, use the prototype option instead"),__ATOM_UTILS_CUSTOM_ELEMENT_CLASSES__[e]?(s=__ATOM_UTILS_CUSTOM_ELEMENT_CLASSES__[e],n(s.prototype,l),null!=a&&i(s,a),s):(o=Object.create(HTMLElement.prototype),n(o,l),s=document.registerElement(e,{prototype:Object.create(o)}),null!=a&&i(s,a),__ATOM_UTILS_CUSTOM_ELEMENT_CLASSES__[e]=s)}})),mi=i((function(e){!function(){var t,i,n,r;for(r in e.exports=n=function(){function e(){"function"==typeof this.extended&&this.extended()}return e.includeInto=function(e){var i,n,r;for(i in this.extend(e.prototype),this)n=this[i],-1===t.indexOf(i)&&(e.hasOwnProperty(i)||(e[i]=n));return null!=(r=this.included)?r.call(e):void 0},e.extend=function(e){var t,n,r,s,o;for(n=0,r=(s=Object.getOwnPropertyNames(this.prototype)).length;r>n;n++)-1===i.indexOf(t=s[n])&&(e.hasOwnProperty(t)||(e[t]=this.prototype[t]));return null!=(o=this.prototype.extended)?o.call(e):void 0},e}(),t=["__super__"],n)t.push(r);i=["constructor","extended"]}()})),gi=i((function(e){var t;t=mi,e.exports=class e extends t{static parents(e,t="*"){var i;return i=[],this.eachParent(e,(e=>{if("function"==typeof e.matches?e.matches(t):void 0)return i.push(e)})),i}static eachParent(e,t){var i,n;for(null!=(i=e.parentNode)&&t(i),n=[];i=i.parentNode;)n.push(null!=i?t(i):void 0);return n}parents(t="*"){return e.parents(this,t)}queryParentSelectorAll(e){if(null==e)throw Error("::queryParentSelectorAll requires a valid selector as argument");return this.parents(e)}queryParentSelector(e){if(null==e)throw Error("::queryParentSelector requires a valid selector as argument");return this.queryParentSelectorAll(e)[0]}eachParent(t){return e.eachParent(this,t)}}})),fi=i((e=>{(()=>{var t,i;i=mi,({Disposable:t}=ni.default),e.exports=class extends i{addDisposableEventListener(e,i,n,r){return e.addEventListener(i,n,r),new t((()=>e.removeEventListener(i,n)))}}})()})),vi=i((function(e){!function(){var t,i,n,r,s,o;r=mi,n=fi,({Disposable:i,CompositeDisposable:t}=ni.default),o=(e,t)=>{var i,n;for(i in n=[],e)n.push(t(i,e[i]));return n},s="__NONE__",e.exports=function(){class e extends r{subscribeTo(e,t,n,r){var a,l;return e instanceof HTMLElement||([e,t,n,r]=[this,e,t,n]),"object"==typeof t&&([n,t,r]=[t,s,n]),null==this.eventsMap&&(this.eventsMap=new WeakMap),null==this.disposablesMap&&(this.disposablesMap=new WeakMap),null==this.eventsMap.get(e)&&this.eventsMap.set(e,{}),null==this.disposablesMap.get(e)&&this.disposablesMap.set(e,{}),l=this.eventsMap.get(e),a=this.disposablesMap.get(e),o(n,((i,n)=>(null==l[i]&&(l[i]={},a[i]=this.createEventListener(e,i,r)),l[i][t]=n))),new i((()=>this.unsubscribeFrom(e,t,n)))}unsubscribeFrom(e,t,i){var n,r,o;if(e instanceof HTMLElement||([e,t,i]=[this,e,t]),"object"==typeof t&&([i,t]=[t,s]),o=this.eventsMap.get(e)){for(r in i)delete o[r][t],0===Object.keys(o[r]).length&&((n=this.disposablesMap.get(e))[r].dispose(),delete n[r],delete o[r]);return 0===Object.keys(o).length?(this.eventsMap.delete(e),this.disposablesMap.delete(e)):void 0}}createEventListener(e,t,i){return this.addDisposableEventListener(e,t,(i=>{var n,r,s;if(n=null!=(r=this.eventsMap.get(e))?r[t]:void 0)return({target:s}=i),this.decorateEvent(i),this.eachSelectorFromTarget(i,s,n),i.isPropagationStopped||"function"==typeof n.__NONE__&&n.__NONE__(i),!0}),i)}eachSelectorFromTarget(e,t,i){return this.nodeAndItsAncestors(t,(t=>{if(!e.isPropagationStopped)return this.eachSelector(i,((i,n)=>{var r;if(r=this.targetMatch(t,i),!e.isImmediatePropagationStopped&&r)return n(e)}))}))}eachSelector(e,t){var i,n,r,o;for(-1!==(r=Object.keys(e)).indexOf(s)&&r.splice(r.indexOf(s),1),r.sort(((e,t)=>t.split(" ").length-e.split(" ").length)),i=0,o=r.length;o>i;i++)if(t(n=r[i],e[n]))return!0;return!1}targetMatch(e,t){var i;if(e.matches(t))return!0;for(i=e.parentNode;null!=i&&null!=i.matches;){if(i.matches(t))return!0;i=i.parentNode}return!1}nodeAndItsAncestors(e,t){var i,n;for(i=e.parentNode,t(e),n=[];null!=i&&null!=i.matches;)t(i),n.push(i=i.parentNode);return n}decorateEvent(e){var t,i;return t=Event.prototype.stopPropagation,e.stopPropagation=function(){return this.isPropagationStopped=!0,t.apply(this,arguments)},i=Event.prototype.stopImmediatePropagation,e.stopImmediatePropagation=function(){return this.isImmediatePropagationStopped=!0,i.apply(this,arguments)}}}return n.includeInto(e),e}()}()})),yi=i((function(e){var t,i,n,r,s,o,a;n=mi,o="a abbr address article aside audio b bdi bdo blockquote body button canvas caption cite code colgroup datalist dd del details dfn dialog div dl dt em fieldset figcaption figure footer form h1 h2 h3 h4 h5 h6 head header html i iframe ins kbd label legend li main map mark menu meter nav noscript object ol optgroup option output p pre progress q rp rt ruby s samp script section select small span strong style sub summary sup table tbody td textarea tfoot th thead time title tr u ul var video area base br col command embed hr img input keygen link meta param source track wbr".split(/\s+/),r={},"area base br col command embed hr img input keygen link meta param source track wbr".split(/\s+/).forEach((e=>r[e]=!0)),t=class extends n{buildContent(){if(null!=this.constructor.content)return s.buildContent(this,this.constructor.content)}},e.exports=s=function(){class e extends n{static includeInto(t){return super.includeInto(t),Object.defineProperty(t,"content",{enumerable:!1,get(){return this.prototype.__content__},set(e){return this.prototype.__content__=e}}),Object.defineProperty(t.prototype,"createdCallback",{enumerable:!0,get(){return this.__create__},set(e){return this.__createdCallback__=e}}),Object.defineProperty(t.prototype,"__create__",{enumerable:!0,value(){if(null!=this.__content__&&e.buildContent(this,this.__content__),null!=this.__createdCallback__)return this.__createdCallback__()}}),t.useShadowRoot=()=>t.prototype.__useShadowRoot__=!0}static buildContent(e,t){var i,n,r;return r=new a,t.call(r),[i]=r.buildHtml(),(n=n=e.__useShadowRoot__?e.shadowRoot=e.createShadowRoot():e).innerHTML=i,this.wireOutlets(e,n)}static wireOutlets(e,t){var i,n,r,s;for(n=0,r=(s=t.querySelectorAll("[outlet]")).length;r>n;n++)e[(i=s[n]).getAttribute("outlet")]=i,i.removeAttribute("outlet")}}return e.Babel=t,e}(),a=function(){class e{constructor(){this.currentBuilder=new i}subview(e,t){return this.currentBuilder.subview(e,t)}text(e){return this.currentBuilder.text(e)}tag(e,...t){return this.currentBuilder.tag(e,...t)}raw(e){return this.currentBuilder.raw(e)}buildHtml(){return this.currentBuilder.buildHtml()}}return o.forEach((function(t){return e.prototype[t]=function(...e){return this.currentBuilder.tag(t,...e)}})),e}(),i=class{constructor(){this.document=[],this.postProcessingSteps=[]}buildHtml(){return[this.document.join(""),this.postProcessingSteps]}tag(e,...t){var i;if(i=this.extractOptions(t),this.openTag(e,i.attributes),!r.hasOwnProperty(e))return"function"==typeof i.content&&i.content(),i.text&&this.text(i.text),this.closeTag(e);if(null!=i.text||null!=i.content)throw Error(`Self-closing tag ${e} cannot have text or content`)}openTag(e,t){var i,n,r;return 0===this.document.length&&null==t&&(t={}),r=(n=(()=>{var e;for(i in e=[],t)e.push(`${i}="${t[i]}"`);return e})()).length?" "+n.join(" "):"",this.document.push(`<${e}${r}>`)}closeTag(e){return this.document.push(`</${e}>`)}text(e){var t;return t=e.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&#39;").replace(/</g,"&lt;").replace(/>/g,"&gt;"),this.document.push(t)}raw(e){return this.document.push(e)}subview(e,t){var i;return i="subview-"+ ++idCounter,this.tag("div",{id:i}),this.postProcessingSteps.push((n=>(n[e]=t,t.parentView=n,n.find("div#"+i).replaceWith(t))))}extractOptions(e){var t,i,n,r;for(r={},i=0,n=e.length;n>i;i++)switch(typeof(t=e[i])){case"function":r.content=t;break;case"string":case"number":r.text=""+t;break;default:r.attributes=t}return r}}})),bi=i((e=>{e.exports={requirePackages(...e){return new Promise(((t,i)=>{var n,r,s,o;return s=[],n=[],r=e.length,o=()=>{if(0==--r)return n.length>0?i(n):t(s)},e.forEach(((e,t)=>{var i,r;return i=e=>(n[t]=e,o()),null!=(r=atom.packages.activatePackage(e).then((e=>(s[t]=e.mainModule,o())))).fail?r.fail(i):null!=r.catch?r.catch(i):void 0}))}))},registerOrUpdateElement:pi,Ancestors:gi,AncestorsMethods:gi,DisposableEvents:fi,EventsDelegation:vi,SpacePenDSL:yi}})),Si=i((e=>{(e.exports={}).forEach=(e,t)=>{for(var i=0;e.length>i;i++){var n=t(e[i]);if(n)return n}}})),wi=i((e=>{var t=e.exports={};t.isIE=e=>{return!(-1===(t=navigator.userAgent.toLowerCase()).indexOf("msie")&&-1===t.indexOf("trident")&&-1===t.indexOf(" edge/")||e&&e!==(()=>{var e=3,t=document.createElement("div"),i=t.getElementsByTagName("i");do{t.innerHTML="\x3c!--[if gt IE "+ ++e+"]><i></i><![endif]--\x3e"}while(i[0]);return e>4?e:void 0})());var t},t.isLegacyOpera=()=>!!window.opera})),xi=i((e=>{(e.exports={}).getOption=(e,t,i)=>{var n=e[t];return null==n&&void 0!==i?i:n}})),Ei={initState:e=>(e._erd={},d(e)),getState:d,cleanState(e){delete e._erd}},Ci=Si.forEach,Ti=Si.forEach,Mi="object"==typeof self&&self.self===self&&self||"object"==typeof global&&global.global===global&&global||Function("","return this")()||{},ki=Array.prototype,Di=Object.prototype,Ai="undefined"!=typeof Symbol?Symbol.prototype:null,Li=ki.push,Oi=ki.slice,_i=Di.toString,Ri=Di.hasOwnProperty,Pi="undefined"!=typeof ArrayBuffer,Ii=Array.isArray,Hi=Object.keys,Ni=Object.create,ji=Pi&&ArrayBuffer.isView,Fi=isNaN,Wi=isFinite,Bi=!{toString:null}.propertyIsEnumerable("toString"),qi=["valueOf","isPrototypeOf","toString","propertyIsEnumerable","hasOwnProperty","toLocaleString"];const zi=x("String"),Ui=x("Number"),Vi=x("Date"),$i=x("RegExp"),Qi=x("Error"),Ki=x("Symbol"),Zi=x("Map"),Gi=x("WeakMap"),Yi=x("Set"),Xi=x("WeakSet"),Ji=x("ArrayBuffer"),en=x("DataView"),tn=Ii||x("Array");var nn=x("Function");"function"!=typeof/./&&"object"!=typeof Int8Array&&"function"!=typeof(Mi.document&&Mi.document.childNodes)&&(nn=e=>"function"==typeof e||!1);const rn=nn;var sn=x("Arguments");!function(){sn(arguments)||(sn=e=>E(e,"callee"))}();const on=sn,an=D("byteLength"),ln=k(an);var cn=/\[object ((I|Ui)nt(8|16|32)|Float(32|64)|Uint8Clamped|Big(I|Ui)nt64)Array\]/;const hn=Pi?e=>ji?ji(e)&&!en(e):ln(e)&&cn.test(_i.call(e)):M(!1),dn=D("length"),un=k(dn);R.VERSION="1.11.0",R.prototype.valueOf=R.prototype.toJSON=R.prototype.value=function(){return this._wrapped},R.prototype.toString=function(){return this._wrapped+""};const pn=q(N),mn=q(L),gn=q(N,!0);R.iteratee=ee;const fn=Date.now||(()=>(new Date).getTime()),vn={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},yn=ae(vn),bn=ae(W(vn)),Sn=R.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var wn={"'":"'","\\":"\\","\r":"r","\n":"n","\u2028":"u2028","\u2029":"u2029"},xn=0,En=f((function(e,t){var i=En.placeholder,n=function(){for(var r=0,s=t.length,o=Array(s),a=0;s>a;a++)o[a]=t[a]===i?arguments[r++]:t[a];for(;arguments.length>r;)o.push(arguments[r++]);return pe(e,n,this,this,o)};return n}));En.placeholder=R;const Cn=f((function(e,t,i){if(!rn(e))throw new TypeError("Bind must be called on a function");var n=f((function(r){return pe(e,n,t,this,i.concat(r))}));return n})),Tn=f(((e,t)=>{var i=(t=me(t,!1,!1)).length;if(1>i)throw Error("bindAll must be passed function names");for(;i--;){var n=t[i];e[n]=Cn(e[n],e)}return e})),Mn=f(((e,t,i)=>setTimeout((()=>e.apply(null,i)),t))),kn=En(Mn,R,1),Dn=En(xe,2),An=Ce(1),Ln=Ce(-1),On=Me(1,An,Te),_n=Me(-1,Ln),Rn=Oe(1),Pn=Oe(-1),In=f(((e,t,i)=>{var n,r;return rn(t)?r=t:tn(t)&&(n=t.slice(0,-1),t=t[t.length-1]),Le(e,(e=>{var s=r;if(!s){if(n&&n.length&&(e=G(e,n)),null==e)return;s=e[t]}return null==s?s:s.apply(e,i)}))})),Hn=Ue(((e,t,i)=>{E(e,i)?e[i].push(t):e[i]=[t]})),Nn=Ue(((e,t,i)=>{e[i]=t})),jn=Ue(((e,t,i)=>{E(e,i)?e[i]++:e[i]=1})),Fn=Ue(((e,t,i)=>{e[i?0:1].push(t)}),!0),Wn=f(((e,t)=>{var i={},n=t[0];if(null==e)return i;rn(n)?(t.length>1&&(n=X(n,t[1])),t=N(e)):(n=Qe,t=me(t,!1,!1),e=Object(e));for(var r=0,s=t.length;s>r;r++){var o=t[r],a=e[o];n(a,o,e)&&(i[o]=a)}return i})),Bn=f(((e,t)=>{var i,n=t[0];return rn(n)?(n=be(n),t.length>1&&(i=t[1])):(t=Le(me(t,!1,!1),String),n=(e,i)=>!He(t,i)),Wn(e,n,i)})),qn=f(((e,t)=>(t=me(t,!0,!0),_e(e,(e=>!He(t,e)))))),zn=f(((e,t)=>qn(e,t))),Un=f((e=>et(me(e,!0,!0)))),Vn=f(it);Ae(["pop","push","reverse","shift","sort","splice","unshift"],(function(e){var t=ki[e];R.prototype[e]=function(){var i=this._wrapped;return null!=i&&(t.apply(i,arguments),"shift"!==e&&"splice"!==e||0!==i.length||delete i[0]),ot(this,i)}})),Ae(["concat","join","slice"],(function(e){var t=ki[e];R.prototype[e]=function(){var e=this._wrapped;return null!=e&&(e=t.apply(e,arguments)),ot(this,e)}}));var $n=at(Object.freeze({__proto__:null,VERSION:"1.11.0",restArguments:f,isObject:v,isNull:y,isUndefined:b,isBoolean:S,isElement:w,isString:zi,isNumber:Ui,isDate:Vi,isRegExp:$i,isError:Qi,isSymbol:Ki,isMap:Zi,isWeakMap:Gi,isSet:Yi,isWeakSet:Xi,isArrayBuffer:Ji,isDataView:en,isArray:tn,isFunction:rn,isArguments:on,isFinite:C,isNaN:T,isTypedArray:hn,isEmpty:O,isMatch:_,isEqual:H,keys:L,allKeys:N,values:j,pairs:F,invert:W,functions:B,methods:B,extend:pn,extendOwn:mn,assign:mn,defaults:gn,create:U,clone:V,tap:$,has:Q,mapObject:ie,identity:K,constant:M,noop:ne,property:Y,propertyOf:re,matcher:Z,matches:Z,times:se,random:oe,now:fn,escape:yn,unescape:bn,templateSettings:Sn,template:ce,result:he,uniqueId:de,chain:ue,iteratee:ee,partial:En,bind:Cn,bindAll:Tn,memoize:ge,delay:Mn,defer:kn,throttle:fe,debounce:ve,wrap:ye,negate:be,compose:Se,after:we,before:xe,once:Dn,findKey:Ee,findIndex:An,findLastIndex:Ln,sortedIndex:Te,indexOf:On,lastIndexOf:_n,find:ke,detect:ke,findWhere:De,each:Ae,forEach:Ae,map:Le,collect:Le,reduce:Rn,foldl:Rn,inject:Rn,reduceRight:Pn,foldr:Pn,filter:_e,select:_e,reject:Re,every:Pe,all:Pe,some:Ie,any:Ie,contains:He,includes:He,include:He,invoke:In,pluck:Ne,where:je,max:Fe,min:We,shuffle:qe,sample:Be,sortBy:ze,groupBy:Hn,indexBy:Nn,countBy:jn,partition:Fn,toArray:Ve,size:$e,pick:Wn,omit:Bn,first:Ze,head:Ze,take:Ze,initial:Ke,last:Ye,rest:Ge,tail:Ge,drop:Ge,compact:Xe,flatten:Je,without:zn,uniq:et,unique:et,union:Un,intersection:tt,difference:qn,unzip:it,transpose:it,zip:Vn,object:nt,range:rt,chunk:st,mixin:at,default:R}));$n._=$n;const Qn=t(Object.freeze({__proto__:null,default:$n,VERSION:"1.11.0",restArguments:f,isObject:v,isNull:y,isUndefined:b,isBoolean:S,isElement:w,isString:zi,isNumber:Ui,isDate:Vi,isRegExp:$i,isError:Qi,isSymbol:Ki,isMap:Zi,isWeakMap:Gi,isSet:Yi,isWeakSet:Xi,isArrayBuffer:Ji,isDataView:en,isArray:tn,isFunction:rn,isArguments:on,isFinite:C,isNaN:T,isTypedArray:hn,isEmpty:O,isMatch:_,isEqual:H,keys:L,allKeys:N,values:j,pairs:F,invert:W,functions:B,methods:B,extend:pn,extendOwn:mn,assign:mn,defaults:gn,create:U,clone:V,tap:$,has:Q,mapObject:ie,identity:K,constant:M,noop:ne,property:Y,propertyOf:re,matcher:Z,matches:Z,times:se,random:oe,now:fn,escape:yn,unescape:bn,templateSettings:Sn,template:ce,result:he,uniqueId:de,chain:ue,iteratee:ee,partial:En,bind:Cn,bindAll:Tn,memoize:ge,delay:Mn,defer:kn,throttle:fe,debounce:ve,wrap:ye,negate:be,compose:Se,after:we,before:xe,once:Dn,findKey:Ee,findIndex:An,findLastIndex:Ln,sortedIndex:Te,indexOf:On,lastIndexOf:_n,find:ke,detect:ke,findWhere:De,each:Ae,forEach:Ae,map:Le,collect:Le,reduce:Rn,foldl:Rn,inject:Rn,reduceRight:Pn,foldr:Pn,filter:_e,select:_e,reject:Re,every:Pe,all:Pe,some:Ie,any:Ie,contains:He,includes:He,include:He,invoke:In,pluck:Ne,where:je,max:Fe,min:We,shuffle:qe,sample:Be,sortBy:ze,groupBy:Hn,indexBy:Nn,countBy:jn,partition:Fn,toArray:Ve,size:$e,pick:Wn,omit:Bn,first:Ze,head:Ze,take:Ze,initial:Ke,last:Ye,rest:Ge,tail:Ge,drop:Ge,compact:Xe,flatten:Je,without:zn,uniq:et,unique:et,union:Un,intersection:tt,difference:qn,unzip:it,transpose:it,zip:Vn,object:nt,range:rt,chunk:st,mixin:at}));var Kn=i((function(e){!function(){var t,i,n,r,s,o,a,l,c=[].slice;n={cmd:"⌘",ctrl:"⌃",alt:"⌥",option:"⌥",shift:"⇧",enter:"⏎",left:"←",right:"→",up:"↑",down:"↓"},r={cmd:"Cmd",ctrl:"Ctrl",alt:"Alt",option:"Alt",shift:"Shift",enter:"Enter",left:"Left",right:"Right",up:"Up",down:"Down"},o={"~":"`",_:"-","+":"=","|":"\\","{":"[","}":"]",":":";",'"':"'","<":",",">":".","?":"/"},a=e=>{var t,i,n,r,s;if(n=0,i=[],null==e)return i;for(t=r=0,s=e.length;s>r;t=++r)"."!==e[t]||0!==t&&"\\"===e[t-1]||(i.push(e.substring(n,t)),n=t+1);return i.push(e.substr(n,e.length)),i},i=e=>l.isObject(e)&&!l.isArray(e),s={adviseBefore(e,t,i){var n;return n=e[t],e[t]=function(){var e;if(e=1>arguments.length?[]:c.call(arguments,0),!1!==i.apply(this,e))return n.apply(this,e)}},camelize:e=>e?e.replace(/[_-]+(\w)/g,(e=>e[1].toUpperCase())):"",capitalize:e=>e?"github"===e.toLowerCase()?"GitHub":e[0].toUpperCase()+e.slice(1):"",compactObject(e){var t,i,n;for(t in i={},e)null!=(n=e[t])&&(i[t]=n);return i},dasherize:e=>e?(e=e[0].toLowerCase()+e.slice(1)).replace(/([A-Z])|(_)/g,((e,t)=>t?"-"+t.toLowerCase():"-")):"",deepClone:e=>l.isArray(e)?e.map((e=>s.deepClone(e))):l.isObject(e)&&!l.isFunction(e)?s.mapObject(e,((e,t)=>[e,s.deepClone(t)])):e,deepExtend(e){var t,n,r,o,a,l,c;for(o=e,t=0;++t<arguments.length;)if(r=arguments[t],i(o)&&i(r))for(a=0,l=(c=Object.keys(r)).length;l>a;a++)o[n=c[a]]=s.deepExtend(o[n],r[n]);else o=s.deepClone(r);return o},deepContains(e,t){var i,n;if(null==e)return!1;for(i=0,n=e.length;n>i;i++)if(l.isEqual(e[i],t))return!0;return!1},endsWith:(e,t)=>(null==t&&(t=""),!!e&&-1!==e.indexOf(t,e.length-t.length)),escapeAttribute:e=>e?e.replace(/"/g,"&quot;").replace(/\n/g,"").replace(/\\/g,"-"):"",escapeRegExp:e=>e?e.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&"):"",humanizeEventName(e,t){var i,n,r,o;return n=(o=e.split(":"))[0],null==(i=o[1])?s.undasherize(n):(r=s.undasherize(n),null==t&&(t=s.undasherize(i)),r+": "+t)},humanizeKey(e,t){var i;return null==t&&(t=process.platform),e?(i="darwin"===t?n:r)[e]?i[e]:1===e.length&&null!=o[e]?[i.shift,o[e]]:1===e.length&&e===e.toUpperCase()&&e.toUpperCase()!==e.toLowerCase()?[i.shift,e.toUpperCase()]:1===e.length||/f[0-9]{1,2}/.test(e)?e.toUpperCase():"darwin"===t?e:s.capitalize(e):e},humanizeKeystroke(e,t){var i,n,r,o,a,c,h,d,u,p;if(null==t&&(t=process.platform),!e)return e;for(i=[],h=0,u=(a=e.split(" ")).length;u>h;h++){for(o=[],n=d=0,p=(c=(e=a[h]).split("-")).length;p>d;n=++d)""===(r=c[n])&&""===c[n-1]&&(r="-"),r&&o.push(s.humanizeKey(r,t));o=(o=l.uniq(l.flatten(o))).join("darwin"===t?"":"+"),i.push(o)}return i.join(" ")},isSubset:(e,t)=>l.every(e,(e=>l.include(t,e))),losslessInvert(e){var t,i,n;for(i in t={},e)null==t[n=e[i]]&&(t[n]=[]),t[n].push(i);return t},mapObject(e,t){var i,n,r,s,o,a;for(n={},r=0,s=(o=Object.keys(e)).length;s>r;r++)n[i=(a=t(i=o[r],e[i]))[0]]=a[1];return n},multiplyString(e,t){var i,n;for(i="",n=0;t>n;)i+=e,n++;return i},pluralize:(e,t,i)=>(null==e&&(e=0),null==i&&(i=t+"s"),1===e?e+" "+t:e+" "+i),remove(e,t){var i;return 0>(i=e.indexOf(t))||e.splice(i,1),e},setValueForKeyPath(e,t,i){var n,r;for(r=a(t);r.length>1;)null==e[n=r.shift()]&&(e[n]={}),e=e[n];return null!=i?e[r.shift()]=i:delete e[r.shift()]},hasKeyPath(e,t){var i,n,r,s;for(r=0,s=(n=a(t)).length;s>r;r++){if(!e.hasOwnProperty(i=n[r]))return!1;e=e[i]}return!0},spliceWithArray(e,t,i,n,r){var s,o,a,l;if(null==r&&(r=1e5),r>n.length)return e.splice.apply(e,[t,i].concat(c.call(n)));for(e.splice(t,i),l=[],s=o=0,a=n.length;r>0?a>=o:o>=a;s=o+=r)l.push(e.splice.apply(e,[t+s,0].concat(c.call(n.slice(s,s+r)))));return l},sum(e){var t,i,n;for(t=0,i=0,n=e.length;n>i;i++)t+=e[i];return t},uncamelcase(e){var t;return e?(t=e.replace(/([A-Z])|_+/g,((e,t)=>(null==t&&(t="")," "+t))),s.capitalize(t.trim())):""},undasherize:e=>e?e.split("-").map(s.capitalize).join(" "):"",underscore:e=>e?(e=e[0].toLowerCase()+e.slice(1)).replace(/([A-Z])|-+/g,((e,t)=>(null==t&&(t=""),"_"+t.toLowerCase()))):"",valueForKeyPath(e,t){var i,n,r;for(n=0,r=(i=a(t)).length;r>n;n++)if(null==(e=e[i[n]]))return;return e},isEqual:(e,i,n,r)=>l.isArray(n)&&l.isArray(r)?t(e,i,n,r):t(e,i),isEqualForProperties(){var e,t,i,n,r,s;for(e=arguments[0],t=arguments[1],r=0,s=(i=3>arguments.length?[]:c.call(arguments,2)).length;s>r;r++)if(!l.isEqual(e[n=i[r]],t[n]))return!1;return!0}},t=(e,i,n,r)=>{var s,o,a,c,h,d,u,p,m,g,f,v,y;if(null==n&&(n=[]),null==r&&(r=[]),e===i)return l.isEqual(e,i);if(l.isFunction(e)||l.isFunction(i))return l.isEqual(e,i);for(f=n.length;f--;)if(n[f]===e)return r[f]===i;if(n.push(e),r.push(i),p=!1,l.isFunction(null!=e?e.isEqual:void 0))p=e.isEqual(i,n,r);else if(l.isFunction(null!=i?i.isEqual:void 0))p=i.isEqual(e,r,n);else if(l.isArray(e)&&l.isArray(i)&&e.length===i.length){for(p=!0,m=v=0,y=e.length;y>v;m=++v)if(!t(e[m],i[m],n,r)){p=!1;break}}else if(l.isRegExp(e)&&l.isRegExp(i))p=l.isEqual(e,i);else if(l.isElement(e)&&l.isElement(i))p=e===i;else if(l.isObject(e)&&l.isObject(i))if(h=i.constructor,o=l.isFunction(s=e.constructor)&&s instanceof s,d=l.isFunction(h)&&h instanceof h,s===h||o&&d){for(g in a=0,p=!0,e)if(c=e[g],l.has(e,g)&&(a++,!l.has(i,g)||!t(c,i[g],n,r))){p=!1;break}if(p){for(g in u=0,i)l.has(i,g)&&u++;p=a===u}}else p=!1;else p=l.isEqual(e,i);return n.pop(),r.pop(),p},e.exports=(l=Qn).extend({},l,s)}()}));class Zn{constructor(){this.canvas=document.createElement("canvas");const e="linux"!==process.platform;this.context=this.canvas.getContext("2d",{desynchronized:e}),this.canvas.webkitImageSmoothingEnabled=!1,this.context.imageSmoothingEnabled=!1,this.offscreenCanvas=document.createElement("canvas"),this.offscreenContext=this.offscreenCanvas.getContext("2d",{desynchronized:e}),this.offscreenCanvas.webkitImageSmoothingEnabled=!1,this.offscreenContext.imageSmoothingEnabled=!1}attach(e){this.canvas.parentNode||e.appendChild(this.canvas)}setSize(e=0,t=0){this.canvas.width=e,this.canvas.height=t,this.context.imageSmoothingEnabled=!1,this.resetOffscreenSize()}getSize(){return{width:this.canvas.width,height:this.canvas.height}}resetOffscreenSize(){this.offscreenCanvas.width=this.canvas.width,this.offscreenCanvas.height=this.canvas.height,this.offscreenContext.imageSmoothingEnabled=!1}copyToOffscreen(){this.canvas.width>0&&this.canvas.height>0&&this.offscreenContext.drawImage(this.canvas,0,0)}copyFromOffscreen(){this.offscreenCanvas.width>0&&this.offscreenCanvas.height>0&&this.context.drawImage(this.offscreenCanvas,0,0)}copyPartFromOffscreen(e,t,i){this.offscreenCanvas.width>0&&this.offscreenCanvas.height>0&&this.context.drawImage(this.offscreenCanvas,0,e,this.offscreenCanvas.width,i,0,t,this.offscreenCanvas.width,i)}clearCanvas(){this.context.clearRect(0,0,this.canvas.width,this.canvas.height)}}const Gn=!1;class Yn extends mi{initializeCanvas(){this.tokensLayer=new Zn,this.backLayer=new Zn,this.frontLayer=new Zn,this.pendingChanges||(this.pendingChanges=[]),this.pendingBackDecorationChanges||(this.pendingBackDecorationChanges=[]),this.pendingFrontDecorationChanges||(this.pendingFrontDecorationChanges=[]),this.maxTokensInOneLine=atom.config.get("minimap.maxTokensInOneLine")}getFrontCanvas(){return this.frontLayer.canvas}attachCanvases(e){this.backLayer.attach(e),this.tokensLayer.attach(e),this.frontLayer.attach(e)}setCanvasesSize(e,t){this.backLayer.setSize(e,t),this.tokensLayer.setSize(e,t),this.frontLayer.setSize(e,t)}updateCanvas(){const e=this.minimap.getFirstVisibleScreenRow(),t=this.minimap.getLastVisibleScreenRow(),i=this.minimap.getDevicePixelRatio(),n=this.minimap.getLineHeight()*i,r=this.minimap.getCharHeight()*i,s=this.minimap.getCharWidth()*i,{width:o,height:a}=this.tokensLayer.getSize(),l=this.minimap.getTextEditor(),c=this.minimap.getTextEditorElement(),h=this.displayCodeHighlights?e=>((e,t,i)=>gt(exports.domStylesReader.retrieveStyleFromDom(e,"color",t,!0),i))(e,c,this.textOpacity):()=>mt(c,this.textOpacity);((e,t,i,n,r,s,o,a,l,c,h,d,u,p,m,g)=>{const f=vt(t,i,s,n,r),v=e.context;if(e.clearCanvas(),0===f.length)ct(t,i,0,o,a,l,c,v,h,d,u,p,m,g);else{for(let i=0,n=f.length;n>i;i++){const n=f[i];e.copyPartFromOffscreen(n.offscreenRow*o,(n.start-t)*o,(n.end-n.start)*o)}let n=t;for(let e=0,i=f.length;i>e;e++){const i=f[e];ct(n,i.start,n-t,o,a,l,c,v,h,d,u,p,m,g),n=i.end}n>i||ct(n,i,n-t,o,a,l,c,v,h,d,u,p,m,g)}e.resetOffscreenSize(),e.copyToOffscreen()})(this.tokensLayer,e,t,this.offscreenFirstRow,this.offscreenLastRow,this.pendingChanges,n,r,s,o,l,l.getScreenLineCount(),(e=>{const t=e.getInvisibles(),i=[];return null!=t.cr&&i.push(t.cr),null!=t.eol&&i.push(t.eol),null!=t.space&&i.push(t.space),null!=t.tab&&i.push(t.tab),0!==i.length?RegExp(i.filter((e=>"string"==typeof e)).map(Kn.escapeRegExp).join("|"),"g"):null})(l),h,this.ignoreWhitespacesInTokens,this.maxTokensInOneLine);const d=this.minimap.decorationsByTypeThenRows(e,t),u={context:this.backLayer.context,canvasWidth:o,canvasHeight:a,lineHeight:n,charWidth:s,charHeight:r,orders:Ht()},p=(e,t,i)=>function(e,t,i,n){const r=e.getProperties().render;r&&(t.color=i,r(e,t,n))}(e,t,i,c);Jn["background-custom"]=p,er["foreground-custom"]=p,((e,t,i,n,r,s,o,a,l,c)=>{const h=vt(t,i,s,n,r);if(e.clearCanvas(),0===h.length)pt(t,i,0,o,a,l,c);else{for(let i=0,n=h.length;n>i;i++){const n=h[i];e.copyPartFromOffscreen(n.offscreenRow*a,(n.start-t)*a,(n.end-n.start)*a)}let n=t;for(let e=0,i=h.length;i>e;e++){const i=h[e];pt(n,i.start,n-t,o,a,l,c),n=i.end}n>i||pt(n,i,n-t,o,a,l,c)}e.resetOffscreenSize(),e.copyToOffscreen()})(this.backLayer,e,t,this.offscreenFirstRow,this.offscreenLastRow,this.pendingBackDecorationChanges,u,n,c,d),u.context=this.frontLayer.context,((e,t,i,n,r,s,o,a,l,c)=>{const h=vt(t,i,s,n,r);if(e.clearCanvas(),0===h.length)ut(t,i,0,o,a,l,c);else{for(let i=0,n=h.length;n>i;i++){const n=h[i];e.copyPartFromOffscreen(n.offscreenRow*a,(n.start-t)*a,(n.end-n.start)*a)}let n=t;for(let e=0,i=h.length;i>e;e++){const i=h[e];ut(n,i.start,n-t,o,a,l,c),n=i.end}n>i||ut(n,i,n-t,o,a,l,c)}e.resetOffscreenSize(),e.copyToOffscreen()})(this.frontLayer,e,t,this.offscreenFirstRow,this.offscreenLastRow,this.pendingFrontDecorationChanges,u,n,c,d),this.pendingChanges=[],this.pendingBackDecorationChanges=[],this.pendingFrontDecorationChanges=[],this.offscreenFirstRow=e,this.offscreenLastRow=t}}const Xn=/^\s+$/,Jn={line(e,t,i){t.context.fillStyle=i,t.context.fillRect(0,t.yRow,t.canvasWidth,t.lineHeight)},"highlight-under":ht},er={gutter(e,t,i){t.context.fillStyle=i,t.context.fillRect(0,t.yRow,1,t.lineHeight)},"highlight-over":ht,"highlight-outline"(e,t,i){let n,r,s,o,a,l;const{lineHeight:c,charWidth:h,canvasWidth:d,screenRow:u}=t,p=e.getMarker().getScreenRange(),m=p.end.row-p.start.row,g=t.yRow,f=g+c;t.context.fillStyle=i,0===m?(r=p.end.column-p.start.column,s=r*h,l=p.start.column*h,a=l+s,t.context.fillRect(l,g,s,1),t.context.fillRect(l,f-1,s,1),t.context.fillRect(l,g,1,c),t.context.fillRect(a,g,1,c)):1===m?(l=p.start.column*t.charWidth,a=p.end.column*t.charWidth,u===p.start.row?(s=t.canvasWidth-l,o=Math.max(l,a),n=t.canvasWidth-o,t.context.fillRect(l,g,s,1),t.context.fillRect(o,f-1,n,1),t.context.fillRect(l,g,1,c),t.context.fillRect(d-1,g,1,c)):(s=d-l,n=d-a,t.context.fillRect(0,g,l,1),t.context.fillRect(0,f-1,a,1),t.context.fillRect(0,g,1,c),t.context.fillRect(a,g,1,c))):(l=p.start.column*h,a=p.end.column*h,u===p.start.row?(s=d-l,t.context.fillRect(l,g,s,1),t.context.fillRect(l,g,1,c),t.context.fillRect(d-1,g,1,c)):u===p.end.row?(s=d-l,t.context.fillRect(0,f-1,a,1),t.context.fillRect(0,g,1,c),t.context.fillRect(a,g,1,c)):(t.context.fillRect(0,g,1,c),t.context.fillRect(d-1,g,1,c),u===p.start.row+1&&t.context.fillRect(0,g,l,1),u===p.end.row-1&&t.context.fillRect(a,f-1,d-a,1)))}},tr=class{static initClass(){return yt(this,bi.EventsDelegation,bi.SpacePenDSL.Babel),bt(this,"minimap-quick-settings")}static content(){this.div({class:"select-list popover-list minimap-quick-settings"},(()=>{this.input({type:"text",class:"hidden-input",outlet:"hiddenInput"}),this.ol({class:"list-group mark-active",outlet:"list"},(()=>{this.li({class:"separator",outlet:"separator"}),this.li({class:"code-highlights",outlet:"codeHighlights"},"code-highlights"),this.li({class:"absolute-mode",outlet:"absoluteMode"},"absolute-mode"),this.li({class:"adjust-absolute-mode-height",outlet:"adjustAbsoluteModeHeight"},"adjust-absolute-mode-height")})),this.div({class:"btn-group"},(()=>{this.button({class:"btn btn-default",outlet:"onLeftButton"},"On Left"),this.button({class:"btn btn-default",outlet:"onRightButton"},"On Right")}))}))}createdCallback(){this.buildContent()}setModel(e){this.selectedItem=null,this.minimap=e,this.emitter=new ti.Emitter,this.subscriptions=new ti.CompositeDisposable,this.plugins={},this.itemsActions=new WeakMap;const t=this.subscriptions;t.add(Ut((({name:e,plugin:t})=>this.addItemFor(e,t)))),t.add(Vt((({name:e,plugin:t})=>this.removeItemFor(e,t)))),t.add($t((({name:e,plugin:t})=>this.activateItem(e,t)))),t.add(Qt((({name:e,plugin:t})=>this.deactivateItem(e,t)))),t.add(atom.commands.add("minimap-quick-settings",{"core:move-up":()=>{this.selectPreviousItem()},"core:move-down":()=>{this.selectNextItem()},"core:move-left"(){atom.config.set("minimap.displayMinimapOnLeft",!0)},"core:move-right"(){atom.config.set("minimap.displayMinimapOnLeft",!1)},"core:cancel":()=>{this.destroy()},"core:confirm":()=>{this.toggleSelectedItem()}})),this.codeHighlights.classList.toggle("active",this.minimap.displayCodeHighlights),t.add(this.subscribeTo(this.codeHighlights,{mousedown:e=>{e.preventDefault(),atom.config.set("minimap.displayCodeHighlights",!this.minimap.displayCodeHighlights)}})),this.itemsActions.set(this.codeHighlights,(()=>{atom.config.set("minimap.displayCodeHighlights",!this.minimap.displayCodeHighlights)})),t.add(this.subscribeTo(this.absoluteMode,{mousedown(e){e.preventDefault(),atom.config.set("minimap.absoluteMode",!atom.config.get("minimap.absoluteMode"))}})),this.itemsActions.set(this.absoluteMode,(()=>{atom.config.set("minimap.absoluteMode",!atom.config.get("minimap.absoluteMode"))})),t.add(this.subscribeTo(this.adjustAbsoluteModeHeight,{mousedown(e){e.preventDefault(),atom.config.set("minimap.adjustAbsoluteModeHeight",!atom.config.get("minimap.adjustAbsoluteModeHeight"))}})),this.itemsActions.set(this.adjustAbsoluteModeHeight,(()=>{atom.config.set("minimap.adjustAbsoluteModeHeight",!atom.config.get("minimap.adjustAbsoluteModeHeight"))})),t.add(this.subscribeTo(this.hiddenInput,{focusout:e=>{this.destroy()}},{passive:!0})),t.add(this.subscribeTo(this.onLeftButton,{mousedown(e){e.preventDefault(),atom.config.set("minimap.displayMinimapOnLeft",!0)}})),t.add(this.subscribeTo(this.onRightButton,{mousedown(e){e.preventDefault(),atom.config.set("minimap.displayMinimapOnLeft",!1)}})),t.add(atom.config.observe("minimap.displayCodeHighlights",(e=>{this.codeHighlights.classList.toggle("active",e)}))),t.add(atom.config.observe("minimap.absoluteMode",(e=>{this.absoluteMode.classList.toggle("active",e)}))),t.add(atom.config.observe("minimap.adjustAbsoluteModeHeight",(e=>{this.adjustAbsoluteModeHeight.classList.toggle("active",e)}))),t.add(atom.config.observe("minimap.displayMinimapOnLeft",(e=>{this.onLeftButton.classList.toggle("selected",e),this.onRightButton.classList.toggle("selected",!e)}))),this.initList()}onDidDestroy(e){return this.emitter.on("did-destroy",e)}attach(){atom.views.getView(atom.workspace).appendChild(this),this.hiddenInput.focus()}destroy(){this.emitter.emit("did-destroy"),this.subscriptions.dispose(),this.parentNode.removeChild(this)}initList(){this.itemsDisposables=new WeakMap;for(const e in pr)this.addItemFor(e,pr[e])}toggleSelectedItem(){const e=this.itemsActions.get(this.selectedItem);"function"==typeof e&&e()}selectNextItem(){this.selectedItem.classList.remove("selected"),null!=this.selectedItem.nextSibling?(this.selectedItem=this.selectedItem.nextSibling,this.selectedItem.matches(".separator")&&(this.selectedItem=this.selectedItem.nextSibling)):this.selectedItem=this.list.firstChild,this.selectedItem.classList.add("selected")}selectPreviousItem(){this.selectedItem.classList.remove("selected"),null!=this.selectedItem.previousSibling?(this.selectedItem=this.selectedItem.previousSibling,this.selectedItem.matches(".separator")&&(this.selectedItem=this.selectedItem.previousSibling)):this.selectedItem=this.list.lastChild,this.selectedItem.classList.add("selected")}addItemFor(e,t){const i=document.createElement("li"),n=()=>{Lt(e)};t.isActive()&&i.classList.add("active"),i.textContent=e,this.itemsActions.set(i,n),this.itemsDisposables.set(i,this.addDisposableEventListener(i,"mousedown",(e=>{e.preventDefault(),n()}))),this.plugins[e]=i,this.list.insertBefore(i,this.separator),null==this.selectedItem&&(this.selectedItem=i,this.selectedItem.classList.add("selected"))}removeItemFor(e,t){try{this.list.removeChild(this.plugins[e])}catch(e){}delete this.plugins[e]}activateItem(e,t){this.plugins[e].classList.add("active")}deactivateItem(e,t){this.plugins[e].classList.remove("active")}}.initClass(),ir=function(e){var t,i;if((e=e||{}).idHandler)t={get:t=>e.idHandler.get(t,!0),set:e.idHandler.set};else{var n=(e=>{var t=e.idGenerator,i=e.stateHandler.getState;return{get(e){var t=i(e);return t&&void 0!==t.id?t.id:null},set(e){var n=i(e);if(!n)throw Error("setId required the element to have a resize detection state.");var r=t.generate();return n.id=r,r}}})({idGenerator:(i=1,{generate:()=>i++}),stateHandler:Ei});t=n}var r=e.reporter;r||(r=(e=>{function t(){}var i={log:t,warn:t,error:t};if(!e&&window.console){var n=(e,t)=>{e[t]=function(){var e=console[t];if(e.apply)e.apply(console,arguments);else for(var i=0;arguments.length>i;i++)e(arguments[i])}};n(i,"log"),n(i,"warn"),n(i,"error")}return i})(!1===r));var s=g(e,"batchProcessor",(e=>{function t(){for(l=!0;a.size();){var e=a;a=h(),e.process()}l=!1}function i(){o=setTimeout(t,0)}var n=(e=e||{}).reporter,r=xi.getOption(e,"async",!0),s=xi.getOption(e,"auto",!0);s&&!r&&(n&&n.warn("Invalid options combination. auto=true and async=false is invalid. Setting async=true."),r=!0);var o,a=h(),l=!1;return{add(e,t){!l&&s&&r&&0===a.size()&&i(),a.add(e,t)},force(e){l||(void 0===e&&(e=r),o&&(clearTimeout(o),o=null),e?i():t())}}})({reporter:r})),o={};o.callOnAdd=!!g(e,"callOnAdd",!0),o.debug=!!g(e,"debug",!1);var a,l=(e=>{function t(t){var n=e.get(t);return void 0===n?[]:i[n]||[]}var i={};return{get:t,add(t,n){var r=e.get(t);i[r]||(i[r]=[]),i[r].push(n)},removeListener(e,i){for(var n=t(e),r=0,s=n.length;s>r;++r)if(n[r]===i){n.splice(r,1);break}},removeAllListeners(e){var i=t(e);i&&(i.length=0)}}})(t),c=(e=>{var t={stateHandler:Ei}.stateHandler.getState;return{isDetectable(e){var i=t(e);return i&&!!i.isDetectable},markAsDetectable(e){t(e).isDetectable=!0},isBusy(e){return!!t(e).busy},markBusy(e,i){t(e).busy=!!i}}})(),d=g(e,"strategy","object"),f=g(e,"important",!1),v={reporter:r,batchProcessor:s,stateHandler:Ei,idHandler:t,important:f};if("scroll"===d&&(wi.isLegacyOpera()?(r.warn("Scroll strategy is not supported on legacy Opera. Changing to object strategy."),d="object"):wi.isIE(9)&&(r.warn("Scroll strategy is not supported on IE9. Changing to object strategy."),d="object")),"scroll"===d)a=(e=>{function t(e){((e,t,n)=>{if(!e.getElementById(t)){var r=n+"_animation",s=n+"_animation_active",o="/* Created by the element-resize-detector library. */\n";o+="."+n+" > div::-webkit-scrollbar { "+i(["display: none"])+" }\n\n",o+="."+s+" { "+i(["-webkit-animation-duration: 0.1s","animation-duration: 0.1s","-webkit-animation-name: "+r,"animation-name: "+r])+" }\n",o+="@-webkit-keyframes "+r+" { 0% { opacity: 1; } 50% { opacity: 0; } 100% { opacity: 1; } }\n",function(i,n){n=n||(t=>{e.head.appendChild(t)});var r=e.createElement("style");r.innerHTML=i,r.id=t,n(r)}(o+="@keyframes "+r+" { 0% { opacity: 1; } 50% { opacity: 0; } 100% { opacity: 1; } }")}})(e,"erd_scroll_detection_scrollbar_style",u)}function i(t){var i=e.important?" !important; ":"; ";return(t.join(i)+i).trim()}function n(e,t,i){if(e.addEventListener)e.addEventListener(t,i);else{if(!e.attachEvent)return a.error("[scroll] Don't know how to add event listeners.");e.attachEvent("on"+t,i)}}function r(e,t,i){if(e.removeEventListener)e.removeEventListener(t,i);else{if(!e.detachEvent)return a.error("[scroll] Don't know how to remove event listeners.");e.detachEvent("on"+t,i)}}function s(e){return c(e).container.childNodes[0].childNodes[0].childNodes[0]}function o(e){return c(e).container.childNodes[0].childNodes[0].childNodes[1]}var a=(e=e||{}).reporter,l=e.batchProcessor,c=e.stateHandler.getState,h=e.idHandler;if(!l)throw Error("Missing required dependency: batchProcessor");if(!a)throw Error("Missing required dependency: reporter.");var d=(()=>{var e=document.createElement("div");e.style.cssText=i(["position: absolute","width: 1000px","height: 1000px","visibility: hidden","margin: 0","padding: 0"]);var t=document.createElement("div");t.style.cssText=i(["position: absolute","width: 500px","height: 500px","overflow: scroll","visibility: none","top: -1500px","left: -1500px","visibility: hidden","margin: 0","padding: 0"]),t.appendChild(e),document.body.insertBefore(t,document.body.firstChild);var n=500-t.clientWidth,r=500-t.clientHeight;return document.body.removeChild(t),{width:n,height:r}})(),u="erd_scroll_detection_container";return t(window.document),{makeDetectable(e,t,r){function p(){if(e.debug){var i=[].slice.call(arguments);if(i.unshift(h.get(t),"Scroll: "),a.log.apply)a.log.apply(null,i);else for(var n=0;i.length>n;n++)a.log(i[n])}}function m(e){var t=c(e).container.childNodes[0],i=window.getComputedStyle(t);return!i.width||-1===i.width.indexOf("px")}function g(){var e=window.getComputedStyle(t),i={};return i.position=e.position,i.width=t.offsetWidth,i.height=t.offsetHeight,i.top=e.top,i.right=e.right,i.bottom=e.bottom,i.left=e.left,i.widthCSS=e.width,i.heightCSS=e.height,i}function f(){if(p("storeStyle invoked."),c(t)){var e=g();c(t).style=e}else p("Aborting because element has been uninstalled")}function v(e,t,i){c(e).lastWidth=t,c(e).lastHeight=i}function y(){return 2*d.width+1}function b(){return 2*d.height+1}function S(e){return e+10+y()}function w(e){return e+10+b()}function x(e,t,i){var n=s(e),r=o(e),a=S(t),l=w(i),c=(e=>2*e+y())(t),h=(e=>2*e+b())(i);n.scrollLeft=a,n.scrollTop=l,r.scrollLeft=c,r.scrollTop=h}function E(){var e=c(t).container;if(!e){(e=document.createElement("div")).className=u,e.style.cssText=i(["visibility: hidden","display: inline","width: 0px","height: 0px","z-index: -1","overflow: hidden","margin: 0","padding: 0"]),c(t).container=e,(e=>{e.className+=" "+u+"_animation_active"})(e),t.appendChild(e);var r=()=>{c(t).onRendered&&c(t).onRendered()};n(e,"animationstart",r),c(t).onAnimationStart=r}return e}function C(){function r(){c(t).onExpand&&c(t).onExpand()}function s(){c(t).onShrink&&c(t).onShrink()}if(p("Injecting elements"),c(t)){(()=>{var i=c(t).style;if("static"===i.position){t.style.setProperty("position","relative",e.important?"important":"");var n=(e,t,i,n)=>{var r=i[n];"auto"!==r&&"0"!==(e=>e.replace(/[^-\d\.]/g,""))(r)&&(e.warn("An element that is positioned static has style."+n+"="+r+" which is ignored due to the static positioning. The element will need to be positioned relative, so the style."+n+" will be set to 0. Element: ",t),t.style[n]=0)};n(a,t,i,"top"),n(a,t,i,"right"),n(a,t,i,"bottom"),n(a,t,i,"left")}})();var o=c(t).container;o||(o=E());var l,h,m,g,f=d.width,v=d.height,y=i(["position: absolute","flex: none","overflow: hidden","z-index: -1","visibility: hidden","width: 100%","height: 100%","left: 0px","top: 0px"]),b=i(["position: absolute","flex: none","overflow: hidden","z-index: -1","visibility: hidden"].concat(["left: "+(l=(l=-(1+f))?l+"px":"0"),"top: "+(h=(h=-(1+v))?h+"px":"0"),"right: "+(g=(g=-f)?g+"px":"0"),"bottom: "+(m=(m=-v)?m+"px":"0")])),S=i(["position: absolute","flex: none","overflow: scroll","z-index: -1","visibility: hidden","width: 100%","height: 100%"]),w=i(["position: absolute","flex: none","overflow: scroll","z-index: -1","visibility: hidden","width: 100%","height: 100%"]),x=i(["position: absolute","left: 0","top: 0"]),C=i(["position: absolute","width: 200%","height: 200%"]),T=document.createElement("div"),M=document.createElement("div"),k=document.createElement("div"),D=document.createElement("div"),A=document.createElement("div"),L=document.createElement("div");T.dir="ltr",T.style.cssText=y,T.className=u,M.className=u,M.style.cssText=b,k.style.cssText=S,D.style.cssText=x,A.style.cssText=w,L.style.cssText=C,k.appendChild(D),A.appendChild(L),M.appendChild(k),M.appendChild(A),T.appendChild(M),o.appendChild(T),n(k,"scroll",r),n(A,"scroll",s),c(t).onExpandScroll=r,c(t).onShrinkScroll=s}else p("Aborting because element has been uninstalled")}function T(){function i(t,i,n){var r=(e=>s(e).childNodes[0])(t),o=S(i),a=w(n);r.style.setProperty("width",o+"px",e.important?"important":""),r.style.setProperty("height",a+"px",e.important?"important":"")}function n(n){var s=t.offsetWidth,o=t.offsetHeight,d=s!==c(t).lastWidth||o!==c(t).lastHeight;p("Storing current size",s,o),v(t,s,o),l.add(0,(()=>{d&&(c(t)?r()?(e.debug&&(t.offsetWidth===s&&t.offsetHeight===o||a.warn(h.get(t),"Scroll: Size changed before updating detector elements.")),i(t,s,o)):p("Aborting because element container has not been initialized"):p("Aborting because element has been uninstalled"))})),l.add(1,(()=>{c(t)?r()?x(t,s,o):p("Aborting because element container has not been initialized"):p("Aborting because element has been uninstalled")})),d&&n&&l.add(2,(()=>{c(t)?r()?n():p("Aborting because element container has not been initialized"):p("Aborting because element has been uninstalled")}))}function r(){return!!c(t).container}function d(){p("notifyListenersIfNeeded invoked");var e=c(t);return void 0===c(t).lastNotifiedWidth&&e.lastWidth===e.startSize.width&&e.lastHeight===e.startSize.height?p("Not notifying: Size is the same as the start size, and there has been no notification yet."):e.lastWidth===e.lastNotifiedWidth&&e.lastHeight===e.lastNotifiedHeight?p("Not notifying: Size already notified"):(p("Current size not notified, notifying..."),e.lastNotifiedWidth=e.lastWidth,e.lastNotifiedHeight=e.lastHeight,void Ci(c(t).listeners,(e=>{e(t)})))}function u(){p("Scroll detected."),m(t)?p("Scroll event fired while unrendered. Ignoring..."):n(d)}if(p("registerListenersAndPositionElements invoked."),c(t)){c(t).onRendered=()=>{if(p("startanimation triggered."),m(t))p("Ignoring since element is still unrendered...");else{p("Element rendered.");var e=s(t),i=o(t);0!==e.scrollLeft&&0!==e.scrollTop&&0!==i.scrollLeft&&0!==i.scrollTop||(p("Scrollbars out of sync. Updating detector elements..."),n(d))}},c(t).onExpand=u,c(t).onShrink=u;var g=c(t).style;i(t,g.width,g.height)}else p("Aborting because element has been uninstalled")}function M(){if(p("finalizeDomMutation invoked."),c(t)){var e=c(t).style;v(t,e.width,e.height),x(t,e.width,e.height)}else p("Aborting because element has been uninstalled")}function k(){r(t)}function D(){var e;p("Installing..."),c(t).listeners=[],e=g(),c(t).startSize={width:e.width,height:e.height},p("Element start size",c(t).startSize),l.add(0,f),l.add(1,C),l.add(2,T),l.add(3,M),l.add(4,k)}r||(r=t,t=e,e=null),e=e||{},p("Making detectable..."),(e=>!(e=>e===e.ownerDocument.body||e.ownerDocument.body.contains(e))(e)||null===window.getComputedStyle(e))(t)?(p("Element is detached"),E(),p("Waiting until element is attached..."),c(t).onRendered=()=>{p("Element is now attached"),D()}):D()},addListener(e,t){if(!c(e).listeners.push)throw Error("Cannot add listener to an element that is not detectable.");c(e).listeners.push(t)},uninstall(e){var t=c(e);t&&(t.onExpandScroll&&r(s(e),"scroll",t.onExpandScroll),t.onShrinkScroll&&r(o(e),"scroll",t.onShrinkScroll),t.onAnimationStart&&r(t.container,"animationstart",t.onAnimationStart),t.container&&e.removeChild(t.container))},initDocument:t}})(v);else{if("object"!==d)throw Error("Invalid strategy name: "+d);a=function(e){function t(t){var i=e.important?" !important; ":"; ";return(t.join(i)+i).trim()}function i(e){return s(e).object}var n=(e=e||{}).reporter,r=e.batchProcessor,s=e.stateHandler.getState;if(!n)throw Error("Missing required dependency: reporter.");return{makeDetectable(e,i,o){o||(o=i,i=e,e=null),e=e||{},wi.isIE(8)?o(i):function(i,o){function a(){function t(){if("static"===h.position){i.style.setProperty("position","relative",e.important?"important":"");var t=(t,i,n,r)=>{var s=n[r];"auto"!==s&&"0"!==(e=>e.replace(/[^-\d\.]/g,""))(s)&&(t.warn("An element that is positioned static has style."+r+"="+s+" which is ignored due to the static positioning. The element will need to be positioned relative, so the style."+r+" will be set to 0. Element: ",i),i.style.setProperty(r,"0",e.important?"important":""))};t(n,i,h,"top"),t(n,i,h,"right"),t(n,i,h,"bottom"),t(n,i,h,"left")}}""!==h.position&&(t(),c=!0);var r=document.createElement("object");r.style.cssText=l,r.tabIndex=-1,r.type="text/html",r.setAttribute("aria-hidden","true"),r.onload=function(){c||t(),function e(t,i){if(!t.contentDocument){var n=s(t);return n.checkForObjectDocumentTimeoutId&&window.clearTimeout(n.checkForObjectDocumentTimeoutId),void(n.checkForObjectDocumentTimeoutId=setTimeout((()=>{n.checkForObjectDocumentTimeoutId=0,e(t,i)}),100))}i(t.contentDocument)}(this,(e=>{o(i)}))},wi.isIE()||(r.data="about:blank"),s(i)&&(i.appendChild(r),s(i).object=r,wi.isIE()&&(r.data="about:blank"))}var l=t(["display: block","position: absolute","top: 0","left: 0","width: 100%","height: 100%","border: none","padding: 0","margin: 0","opacity: 0","z-index: -1000","pointer-events: none"]),c=!1,h=window.getComputedStyle(i),d=i.offsetWidth,u=i.offsetHeight;s(i).startSize={width:d,height:u},r?r.add(a):a()}(i,o)},addListener(e,t){function n(){t(e)}if(wi.isIE(8))s(e).object={proxy:n},e.attachEvent("onresize",n);else{var r=i(e);if(!r)throw Error("Element is not detectable by this strategy.");r.contentDocument.defaultView.addEventListener("resize",n)}},uninstall(e){if(s(e)){var t=i(e);t&&(wi.isIE(8)?e.detachEvent("onresize",t.proxy):e.removeChild(t),s(e).checkForObjectDocumentTimeoutId&&window.clearTimeout(s(e).checkForObjectDocumentTimeoutId),delete s(e).object)}}}}(v)}var y={};return{listenTo(e,i,n){function s(e){var t=l.get(e);Ti(t,(t=>{t(e)}))}function h(e,t,i){l.add(t,i),e&&i(t)}if(n||(n=i,i=e,e={}),!i)throw Error("At least one element required.");if(!n)throw Error("Listener required.");if(m(i))i=[i];else{if(!u(i))return r.error("Invalid arguments. Must be a DOM element or a collection of DOM elements.");i=p(i)}var d=0,v=g(e,"callOnAdd",o.callOnAdd),b=g(e,"onReady",(()=>{})),S=g(e,"debug",o.debug);Ti(i,(e=>{Ei.getState(e)||(Ei.initState(e),t.set(e));var o=t.get(e);if(S&&r.log("Attaching listener to element",o,e),!c.isDetectable(e))return S&&r.log(o,"Not detectable."),c.isBusy(e)?(S&&r.log(o,"System busy making it detectable"),h(v,e,n),y[o]=y[o]||[],void y[o].push((()=>{++d===i.length&&b()}))):(S&&r.log(o,"Making detectable..."),c.markBusy(e,!0),a.makeDetectable({debug:S,important:f},e,(e=>{if(S&&r.log(o,"onElementDetectable"),Ei.getState(e)){c.markAsDetectable(e),c.markBusy(e,!1),a.addListener(e,s),h(v,e,n);var t=Ei.getState(e);t&&t.startSize&&(t.startSize.width===e.offsetWidth&&t.startSize.height===e.offsetHeight||s(e)),y[o]&&Ti(y[o],(e=>{e()}))}else S&&r.log(o,"Element uninstalled before being detectable.");delete y[o],++d===i.length&&b()})));S&&r.log(o,"Already detecable, adding listener."),h(v,e,n),d++})),d===i.length&&b()},removeListener:l.removeListener,removeAllListeners:l.removeAllListeners,uninstall(e){if(!e)return r.error("At least one element is required.");if(m(e))e=[e];else{if(!u(e))return r.error("Invalid arguments. Must be a DOM element or a collection of DOM elements.");e=p(e)}Ti(e,(e=>{l.removeAllListeners(e),a.uninstall(e),Ei.cleanState(e)}))},initDocument(e){a.initDocument&&a.initDocument(e)}}}({strategy:"scroll"});let nr;const rr=class{static initClass(){return yt(this,Yn,bi.EventsDelegation,bi.AncestorsMethods),bt(this,"atom-text-editor-minimap")}createdCallback(){this.minimap=void 0,this.width=void 0,this.height=void 0,this.subscriptions=new ti.CompositeDisposable,this.visibleAreaSubscription=void 0,this.quickSettingsSubscription=void 0,this.dragSubscription=void 0,this.openQuickSettingSubscription=void 0,this.displayMinimapOnLeft=!1,this.minimapScrollIndicator=void 0,this.displayMinimapOnLeft=void 0,this.displayPluginsControls=void 0,this.textOpacity=void 0,this.displayCodeHighlights=void 0,this.adjustToSoftWrap=void 0,this.useHardwareAcceleration=void 0,this.absoluteMode=void 0,this.visibleArea=void 0,this.controls=void 0,this.scrollIndicator=void 0,this.openQuickSettings=void 0,this.quickSettingsElement=void 0,this.attached=void 0,this.attachedToTextEditor=void 0,this.standAlone=void 0,this.wasVisible=void 0,this.offscreenFirstRow=void 0,this.offscreenLastRow=void 0,this.frameRequested=void 0,this.flexBasis=void 0,this.initializeContent(),this.subscriptions.add(atom.config.observe("minimap.displayMinimapOnLeft",(e=>{this.displayMinimapOnLeft=e,e?nr||(nr=document.createElement("style"),nr.setAttribute("context","atom-text-editor-minimap"),document.head.appendChild(nr)):nr&&(nr.parentNode.removeChild(nr),nr=null),this.updateMinimapFlexPosition(),this.measureHeightAndWidth(!0,!0)})),atom.config.observe("minimap.minimapScrollIndicator",(e=>{this.minimapScrollIndicator=e,this.minimapScrollIndicator&&null==this.scrollIndicator&&!this.standAlone?this.initializeScrollIndicator():null!=this.scrollIndicator&&this.disposeScrollIndicator(),this.attached&&this.requestUpdate()})),atom.config.observe("minimap.displayPluginsControls",(e=>{this.displayPluginsControls=e,this.displayPluginsControls&&null==this.openQuickSettings&&!this.standAlone?this.initializeOpenQuickSettings():null!=this.openQuickSettings&&this.disposeOpenQuickSettings()})),atom.config.observe("minimap.textOpacity",(e=>{this.textOpacity=e,this.attached&&this.requestForcedUpdate()})),atom.config.observe("minimap.displayCodeHighlights",(e=>{this.displayCodeHighlights=e,this.attached&&this.requestForcedUpdate()})),atom.config.observe("minimap.smoothScrolling",(e=>{this.smoothScrolling=e,this.attached&&(this.smoothScrolling?this.requestUpdate():(this.backLayer.canvas.style.cssText="",this.tokensLayer.canvas.style.cssText="",this.frontLayer.canvas.style.cssText=""))})),atom.config.observe("minimap.adjustMinimapWidthToSoftWrap",(e=>{this.adjustToSoftWrap=e,this.attached&&this.measureHeightAndWidth()})),atom.config.observe("minimap.adjustMinimapWidthOnlyIfSmaller",(e=>{this.adjustOnlyIfSmaller=e,this.attached&&this.measureHeightAndWidth()})),atom.config.observe("minimap.useHardwareAcceleration",(e=>{this.useHardwareAcceleration=e,this.attached&&this.requestUpdate()})),atom.config.observe("minimap.absoluteMode",(e=>{this.absoluteMode=e,this.classList.toggle("absolute",this.absoluteMode)})),atom.config.observe("minimap.adjustAbsoluteModeHeight",(e=>{this.adjustAbsoluteModeHeight=e,this.classList.toggle("adjust-absolute-height",this.adjustAbsoluteModeHeight),this.attached&&this.measureHeightAndWidth()})),atom.config.observe("minimap.ignoreWhitespacesInTokens",(e=>{this.ignoreWhitespacesInTokens=e,this.attached&&this.requestForcedUpdate()})),atom.config.observe("editor.preferredLineLength",(()=>{this.attached&&this.measureHeightAndWidth()})),atom.config.observe("editor.softWrap",(()=>{this.attached&&this.requestUpdate()})),atom.config.observe("editor.showInvisibles",(()=>{this.attached&&this.requestUpdate()})),atom.config.observe("editor.invisibles",(()=>{this.attached&&this.requestUpdate()})),atom.config.observe("editor.softWrapAtPreferredLineLength",(()=>{this.attached&&this.requestUpdate()})))}attachedCallback(){if("function"==typeof atom.views.pollDocument)this.subscriptions.add(atom.views.pollDocument((()=>{this.pollDOM()})));else{this.intersectionObserver=new IntersectionObserver((e=>{const{intersectionRect:t}=e[e.length-1];(t.width>0||t.height>0)&&this.measureHeightAndWidth(!0,!0)})),this.intersectionObserver.observe(this),this.isVisible()&&this.measureHeightAndWidth(!0,!0);const e=()=>{this.measureHeightAndWidth(!1,!1)};ir.listenTo(this,e),window.addEventListener("resize",e,{passive:!0}),this.subscriptions.add(new ti.Disposable((()=>{ir.removeListener(this,e)})),new ti.Disposable((()=>{window.removeEventListener("resize",e)})))}this.measureHeightAndWidth(),this.updateMinimapFlexPosition(),this.attached=!0,this.attachedToTextEditor=this.queryParentSelector("atom-text-editor")===this.minimap.getTextEditorElement(),this.attachedToTextEditor&&this.minimap.getTextEditorElement().setAttribute("with-minimap",""),this.subscriptions.add(this.subscribeToMediaQuery())}detachedCallback(){this.minimap.getTextEditorElement().removeAttribute("with-minimap"),this.attached=!1}isVisible(){return this.offsetWidth>0||this.offsetHeight>0}attach(e){if(this.attached)return;const t=e||this.minimap.getTextEditorElement(),i=t.querySelectorAll("atom-text-editor-minimap");i.length&&[].forEach.call(i,(e=>{e.destroy()})),t.appendChild(this)}detach(){this.attached&&null!=this.parentNode&&this.parentNode.removeChild(this)}updateMinimapFlexPosition(){this.classList.toggle("left",this.displayMinimapOnLeft)}destroy(){this.subscriptions.dispose(),this.detach(),this.minimap=null}initializeContent(){this.initializeCanvas(),this.attachCanvases(this),this.createVisibleArea(),this.createControls(),this.subscriptions.add(this.subscribeTo(this,{mousewheel:e=>{!this.standAlone&&this.minimap.onMouseWheel&&this.minimap.onMouseWheel(e)}},{passive:!0}),this.subscribeTo(this.getFrontCanvas(),{mousedown:e=>{this.canvasPressed(wt(e))},touchstart:e=>{this.canvasPressed(xt(e))}},{passive:!0}))}createVisibleArea(){this.visibleArea||(this.visibleArea=document.createElement("div"),this.visibleArea.classList.add("minimap-visible-area"),this.appendChild(this.visibleArea),this.visibleAreaSubscription=this.subscribeTo(this.visibleArea,{mousedown:e=>{this.startDrag(wt(e))},touchstart:e=>{this.startDrag(xt(e))}},{passive:!0}),this.subscriptions.add(this.visibleAreaSubscription))}removeVisibleArea(){this.visibleArea&&(this.subscriptions.remove(this.visibleAreaSubscription),this.visibleAreaSubscription.dispose(),this.removeChild(this.visibleArea),delete this.visibleArea)}createControls(){this.controls||this.standAlone||(this.controls=document.createElement("div"),this.controls.classList.add("minimap-controls"),this.appendChild(this.controls))}removeControls(){this.controls&&(this.removeChild(this.controls),delete this.controls)}initializeScrollIndicator(){this.scrollIndicator||this.standAlone||(this.scrollIndicator=document.createElement("div"),this.scrollIndicator.classList.add("minimap-scroll-indicator"),this.controls.appendChild(this.scrollIndicator))}disposeScrollIndicator(){this.scrollIndicator&&(this.controls.removeChild(this.scrollIndicator),delete this.scrollIndicator)}initializeOpenQuickSettings(){this.openQuickSettings||this.standAlone||(this.openQuickSettings=document.createElement("div"),this.openQuickSettings.classList.add("open-minimap-quick-settings"),this.controls.appendChild(this.openQuickSettings),this.openQuickSettingSubscription=this.subscribeTo(this.openQuickSettings,{mousedown:e=>{if(e.preventDefault(),e.stopPropagation(),null!=this.quickSettingsElement)this.quickSettingsElement.destroy(),this.quickSettingsSubscription.dispose();else{this.quickSettingsElement=new tr,this.quickSettingsElement.setModel(this),this.quickSettingsSubscription=this.quickSettingsElement.onDidDestroy((()=>{this.quickSettingsElement=null}));const{top:e,left:t,right:i}=this.getFrontCanvas().getBoundingClientRect();this.quickSettingsElement.style.top=e+"px",this.quickSettingsElement.attach(),this.quickSettingsElement.style.left=this.displayMinimapOnLeft?i+"px":t-this.quickSettingsElement.clientWidth+"px"}}}))}disposeOpenQuickSettings(){this.openQuickSettings&&(this.controls.removeChild(this.openQuickSettings),this.openQuickSettingSubscription.dispose(),delete this.openQuickSettings)}getModel(){return this.minimap}setModel(e){return this.minimap=e,this.subscriptions.add(this.minimap.onDidChangeScrollTop((()=>{this.requestUpdate()})),this.minimap.onDidChangeScrollLeft((()=>{this.requestUpdate()})),this.minimap.onDidDestroy((()=>{this.destroy()})),this.minimap.onDidChangeConfig((()=>{if(this.attached)return this.requestForcedUpdate()})),this.minimap.onDidChangeStandAlone((()=>{this.setStandAlone(this.minimap.isStandAlone()),this.requestUpdate()})),this.minimap.onDidChange((e=>{this.pendingChanges.push(e),this.requestUpdate()})),this.minimap.onDidChangeDecorationRange((e=>{const{type:t}=e;"line"===t||"highlight-under"===t||"background-custom"===t?this.pendingBackDecorationChanges.push(e):this.pendingFrontDecorationChanges.push(e),this.requestUpdate()})),Kt((()=>{this.requestForcedUpdate()}))),this.setStandAlone(this.minimap.isStandAlone()),null!=this.width&&null!=this.height&&this.minimap.setScreenHeightAndWidth(this.height,this.width),this.minimap}setStandAlone(e){this.standAlone=e,this.standAlone?(this.setAttribute("stand-alone",!0),this.disposeScrollIndicator(),this.disposeOpenQuickSettings(),this.removeControls(),this.removeVisibleArea()):(this.removeAttribute("stand-alone"),this.createVisibleArea(),this.createControls(),this.minimapScrollIndicator&&this.initializeScrollIndicator(),this.displayPluginsControls&&this.initializeOpenQuickSettings())}requestUpdate(){this.frameRequested||(this.frameRequested=!0,requestAnimationFrame((()=>{this.update(),this.frameRequested=!1})))}requestForcedUpdate(){this.offscreenFirstRow=null,this.offscreenLastRow=null,this.requestUpdate()}update(){if(!(this.attached&&this.isVisible()&&this.minimap))return;const e=this.minimap;e.enableCache();const t=this.getFrontCanvas(),i=this.minimap.getDevicePixelRatio(),n=e.getTextEditorScaledScrollLeft(),r=e.getTextEditorScaledScrollTop()-e.getScrollTop(),s=Math.min(t.width/i,this.width),o=s+n;this.adjustToSoftWrap&&this.flexBasis?(this.style.flexBasis=this.flexBasis+"px",this.style.width=this.flexBasis+"px"):(this.style.flexBasis=null,this.style.width=null),Et(this.visibleArea,{width:Math.round(o)+"px",height:Math.round(e.getTextEditorScaledHeight())+"px",transform:Ct(0,r,this.useHardwareAcceleration),"border-left-width":Math.round(n)+"px"}),Et(this.controls,{width:Math.round(s)+"px"});const a=e.getFirstVisibleScreenRow()*e.getLineHeight()-e.getScrollTop();if(this.smoothScrolling){let e=Ct(0,a,this.useHardwareAcceleration);if(1!==i){const t=1/i;e+=" "+Tt(t,t,this.useHardwareAcceleration)}Et(this.backLayer.canvas,{transform:e}),Et(this.tokensLayer.canvas,{transform:e}),Et(this.frontLayer.canvas,{transform:e})}else{const e=1/i,t=Tt(e,e,this.useHardwareAcceleration);Et(this.backLayer.canvas,{transform:t}),Et(this.tokensLayer.canvas,{transform:t}),Et(this.frontLayer.canvas,{transform:t})}if(this.minimapScrollIndicator&&!this.scrollIndicator&&e.canScroll()&&this.initializeScrollIndicator(),null!=this.scrollIndicator){const t=e.getScreenHeight(),i=t*(t/e.getHeight()),n=(t-i)*e.getScrollRatio();Et(this.scrollIndicator,{height:i+"px",transform:Ct(0,n,this.useHardwareAcceleration)}),e.canScroll()||this.disposeScrollIndicator()}this.absoluteMode&&this.adjustAbsoluteModeHeight&&this.updateCanvasesSize(),this.updateCanvas(),e.clearCache()}setDisplayCodeHighlights(e){this.displayCodeHighlights=e,this.attached&&this.requestForcedUpdate()}pollDOM(){const e=this.checkForVisibilityChange();this.isVisible()&&(this.wasVisible||this.requestForcedUpdate(),this.measureHeightAndWidth(e,!1))}checkForVisibilityChange(){return this.isVisible()?!this.wasVisible&&(this.wasVisible=!0,this.wasVisible):this.wasVisible?(this.wasVisible=!1,!0):(this.wasVisible=!1,this.wasVisible)}measureHeightAndWidth(e,t=!0){if(!this.minimap)return;const i=this.style.flexBasis;this.style.flexBasis="";const n=this.width!==this.clientWidth||this.height!==this.clientHeight;this.height=this.clientHeight,this.width=this.clientWidth;let r=this.width;if(null!=this.minimap&&this.minimap.setScreenHeightAndWidth(this.height,this.width),(n||e||t)&&this.requestForcedUpdate(),this.isVisible())if(n||t){if(this.adjustToSoftWrap){const e=atom.config.get("editor.preferredLineLength"),t=atom.config.get("editor.softWrap"),i=atom.config.get("editor.softWrapAtPreferredLineLength"),n=e*this.minimap.getCharWidth();!(t&&i&&e)||n>this.width&&this.adjustOnlyIfSmaller?(St(r),delete this.flexBasis):(this.flexBasis=n,r=n,St(n))}else St(r),delete this.flexBasis;this.updateCanvasesSize(r)}else this.style.flexBasis=i}updateCanvasesSize(e){const t=this.minimap.getDevicePixelRatio(),i=this.height+this.minimap.getLineHeight(),n=this.absoluteMode&&this.adjustAbsoluteModeHeight?Math.min(this.minimap.getHeight(),i):i,r=this.getFrontCanvas();null==e&&(e=r.width/t),e===r.width&&n===r.height||(this.setCanvasesSize(e*t,n*t),this.absoluteMode&&this.adjustAbsoluteModeHeight&&(this.offscreenFirstRow=null,this.offscreenLastRow=null))}canvasPressed({y:e,isLeftMouse:t,isMiddleMouse:i}){if(!this.minimap.isStandAlone())if(t)this.canvasLeftMousePressed(e);else if(i){this.canvasMiddleMousePressed(e);const{top:t,height:i}=this.visibleArea.getBoundingClientRect();this.startDrag({y:t+i/2,isLeftMouse:!1,isMiddleMouse:!0})}}canvasLeftMousePressed(e){const t=e-this.getBoundingClientRect().top,i=Math.floor(t/this.minimap.getLineHeight())+this.minimap.getFirstVisibleScreenRow(),n=this.minimap.getTextEditor(),r=this.minimap.getTextEditorElement(),s=i*n.getLineHeightInPixels()-this.minimap.getTextEditorHeight()/2,o=r.pixelPositionForScreenPosition([i,0]).top-this.minimap.getTextEditorHeight()/2;if(atom.config.get("minimap.moveCursorOnMinimapClick")&&n.setCursorScreenPosition([i,0]),atom.config.get("minimap.scrollAnimation")){const e=atom.config.get("minimap.scrollAnimationDuration"),t=this.minimap.scrollIndependentlyOnMouseWheel(),i=this.minimap.getTextEditorScrollTop(),n=o;let r;if(t){const t=this.minimap.getScrollTop(),o=Math.min(1,s/(this.minimap.getTextEditorMaxScrollTop()||1))*this.minimap.getMaxScrollTop();r=(e,i)=>{null!==this.minimap&&(this.minimap.setTextEditorScrollTop(e,!0),this.minimap.setScrollTop(t+(o-t)*i))},Mt({from:i,to:n,duration:e,step:r})}else r=e=>{null!==this.minimap&&this.minimap.setTextEditorScrollTop(e)},Mt({from:i,to:n,duration:e,step:r})}else this.minimap.setTextEditorScrollTop(o)}canvasMiddleMousePressed(e){const{top:t}=this.getBoundingClientRect(),i=(e-t-this.minimap.getTextEditorScaledHeight()/2)/(this.minimap.getVisibleHeight()-this.minimap.getTextEditorScaledHeight());this.minimap.setTextEditorScrollTop(i*this.minimap.getTextEditorMaxScrollTop())}subscribeToMediaQuery(){const e=window.matchMedia("screen and (-webkit-min-device-pixel-ratio: 1.5)"),t=()=>{this.requestForcedUpdate()};return e.addEventListener("change",t),new ti.Disposable((()=>{e.removeEventListener("change",t)}))}startDrag({y:e,isLeftMouse:t,isMiddleMouse:i}){if(!this.minimap)return;if(!t&&!i)return;const n={dragOffset:e-this.visibleArea.getBoundingClientRect().top,offsetTop:this.getBoundingClientRect().top},r=e=>this.drag(wt(e),n),s=()=>this.endDrag(),o=e=>this.drag(xt(e),n);document.body.addEventListener("mousemove",r,{passive:!0}),document.body.addEventListener("mouseup",s,{passive:!0}),document.body.addEventListener("mouseleave",s,{passive:!0}),document.body.addEventListener("touchmove",o,{passive:!0}),document.body.addEventListener("touchend",s,{passive:!0}),document.body.addEventListener("touchcancel",s,{passive:!0}),this.dragSubscription=new ti.Disposable((()=>{document.body.removeEventListener("mousemove",r),document.body.removeEventListener("mouseup",s),document.body.removeEventListener("mouseleave",s),document.body.removeEventListener("touchmove",o),document.body.removeEventListener("touchend",s),document.body.removeEventListener("touchcancel",s)}))}drag({y:e,isLeftMouse:t,isMiddleMouse:i},n){if(!this.minimap)return;if(!t&&!i)return;const r=(e-n.offsetTop-n.dragOffset)/(this.minimap.getVisibleHeight()-this.minimap.getTextEditorScaledHeight());this.minimap.setTextEditorScrollTop(r*this.minimap.getTextEditorMaxScrollTop())}endDrag(){this.minimap&&this.dragSubscription.dispose()}}.initClass(),sr=t(Object.freeze({__proto__:null,default:class{constructor(e){this.textEditor=e}enableCache(){this.useCache=!0}clearCache(){this.useCache=!1,delete this.heightCache,delete this.scrollTopCache,delete this.scrollLeftCache,delete this.maxScrollTopCache}onDidChangeScrollTop(e){return this.textEditor.onDidChangeScrollTop(e)}onDidChangeScrollLeft(e){return this.textEditor.onDidChangeScrollLeft(e)}getHeight(){return this.useCache?(this.heightCache||(this.heightCache=this.textEditor.getHeight()),this.heightCache):this.textEditor.getHeight()}getScrollTop(){return this.useCache?(this.scrollTopCache||(this.scrollTopCache=this.textEditor.getScrollTop()),this.scrollTopCache):this.textEditor.getScrollTop()}setScrollTop(e){return this.textEditor.setScrollTop(e)}getScrollLeft(){return this.useCache?(this.scrollLeftCache||(this.scrollLeftCache=this.textEditor.getScrollLeft()),this.scrollLeftCache):this.textEditor.getScrollLeft()}getMaxScrollTop(){if(null!=this.maxScrollTopCache&&this.useCache)return this.maxScrollTopCache;let e=this.textEditor.displayBuffer.getMaxScrollTop();const t=this.textEditor.getLineHeightInPixels();return this.scrollPastEnd&&(e-=this.getHeight()-3*t),this.useCache&&(this.maxScrollTopCache=e),e}editorDestroyed(){return!this.textEditor||this.textEditor.isDestroyed()}}}));let or=0;class ar{static isType(e,t){return Array.isArray(e.type)?e.type.indexOf(t)>=0:t===e.type}constructor(e,t,i){this.marker=e,this.minimap=t,this.emitter=new ti.Emitter,this.id=or++,this.properties=null,this.setProperties(i),this.properties.id=this.id,this.destroyed=!1,this.markerDestroyDisposable=this.marker.onDidDestroy((()=>{this.destroy()})),this.screenRange=e.getScreenRange()}destroy(){this.destroyed||(this.markerDestroyDisposable.dispose(),this.markerDestroyDisposable=null,this.destroyed=!0,this.emitter.emit("did-destroy"),this.emitter.dispose())}isDestroyed(){return this.destroyed}onDidChangeProperties(e){return this.emitter.on("did-change-properties",e)}onDidDestroy(e){return this.emitter.on("did-destroy",e)}getId(){return this.id}getMarker(){return this.marker}isType(e){return ar.isType(this.properties,e)}getProperties(){return this.properties}setProperties(e){if(this.destroyed)return;const t=this.properties;this.properties=e,this.properties.id=this.id,this.emitter.emit("did-change-properties",{oldProperties:t,newProperties:e})}}class lr{initializeDecorations(){null==this.emitter&&(this.emitter=new ti.Emitter),this.decorationsById=new Map,this.decorationsByMarkerId=new Map,this.decorationMarkerChangedSubscriptions=new Map,this.decorationMarkerDestroyedSubscriptions=new Map,this.decorationUpdatedSubscriptions=new Map,this.decorationDestroyedSubscriptions=new Map}getDecorations(){return this.decorationsById.values()}onDidAddDecoration(e){return this.emitter.on("did-add-decoration",e)}onDidRemoveDecoration(e){return this.emitter.on("did-remove-decoration",e)}onDidChangeDecoration(e){return this.emitter.on("did-change-decoration",e)}onDidChangeDecorationRange(e){return this.emitter.on("did-change-decoration-range",e)}onDidUpdateDecoration(e){return this.emitter.on("did-update-decoration",e)}decorationForId(e){return this.decorationsById.get(e)}decorationsForScreenRowRange(e,t){const i={},n=this.findMarkers({intersectsScreenRowRange:[e,t]});for(let e=0,t=n.length;t>e;e++){const t=n[e],r=this.decorationsByMarkerId.get(t.id);void 0!==r&&(i[t.id]=r)}return i}decorationsByTypeThenRows(){if(null!=this.decorationsByTypeThenRowsCache)return this.decorationsByTypeThenRowsCache;const e={},t=this.decorationsById.values();for(const i of t){const t=i.marker.getScreenRange(),n=i.getProperties().type;null==e[n]&&(e[n]={});for(let r=t.start.row,s=t.end.row;s>=r;r++)null==e[n][r]&&(e[n][r]=[]),e[n][r].push(i)}return this.decorationsByTypeThenRowsCache=e,e}invalidateDecorationForScreenRowsCache(){this.decorationsByTypeThenRowsCache=null}decorateMarker(e,t){if(this.destroyed||null==e)return;const{id:i}=e;"highlight"===t.type&&(t.type="highlight-over");const{type:n,plugin:r}=t;if(null==r&&(t.plugin=(()=>{const e=Error().stack.split("\n")[3].split("(")[1].replace(")",""),t=RegExp(atom.packages.getPackageDirPaths().join("|")+Kn.escapeRegExp(ri.default.sep)),i=e.replace(t,"").split(ri.default.sep)[0].replace(/minimap-|-minimap/,"");return 0>i.indexOf(ri.default.sep)?i:void 0})()),null==t.scope&&null!=t.class){const e=t.class.split(" ").join(".");t.scope=".minimap ."+e}this.decorationMarkerDestroyedSubscriptions.has(i)||this.decorationMarkerDestroyedSubscriptions.set(i,e.onDidDestroy((()=>{this.removeAllDecorationsForMarker(e)}))),this.decorationMarkerChangedSubscriptions.has(i)||this.decorationMarkerChangedSubscriptions.set(i,e.onDidChange((t=>{const r=this.decorationsByMarkerId.get(i),s=e.getScreenRange();if(this.invalidateDecorationForScreenRowsCache(),void 0!==r)for(let i=0,n=r.length;n>i;i++){const n=r[i];this.emitter.emit("did-change-decoration",{marker:e,decoration:n,event:t}),this.emitDecorationChanges(n.type,n),n.screenRange=s}let o=t.oldTailScreenPosition,a=t.oldHeadScreenPosition,l=t.newTailScreenPosition,c=t.newHeadScreenPosition;o.row>a.row&&([o,a]=[a,o]),l.row>c.row&&([l,c]=[c,l]);const h=((e,t,i,n)=>{const r=[];return e.isLessThan(i)?r.push([e,i]):i.isLessThan(e)&&r.push([i,e]),t.isLessThan(n)?r.push([t,n]):n.isLessThan(t)&&r.push([n,t]),r})(o,a,l,c);for(let e=0,t=h.length;t>e;e++){const[t,i]=h[e];this.emitRangeChanges(n,{start:t,end:i},0)}})));const s=new ar(e,this,t);return this.decorationsByMarkerId.has(i)||this.decorationsByMarkerId.set(i,[]),this.decorationsByMarkerId.get(i).push(s),this.decorationsById.set(s.id,s),this.decorationUpdatedSubscriptions.has(s.id)||this.decorationUpdatedSubscriptions.set(s.id,s.onDidChangeProperties((e=>{this.emitDecorationChanges(n,s)}))),this.decorationDestroyedSubscriptions.set(s.id,s.onDidDestroy((()=>{this.removeDecoration(s)}))),this.emitDecorationChanges(n,s),this.emitter.emit("did-add-decoration",{marker:e,decoration:s}),s}emitDecorationChanges(e,t){if(this.editorDestroyed())return;this.invalidateDecorationForScreenRowsCache();const i=t.screenRange;i.start&&i.end&&this.emitRangeChanges(e,i,0)}emitRangeChanges(e,t,i){const n=t.start.row,r=t.end.row,s=this.getLastVisibleScreenRow(),o=this.getFirstVisibleScreenRow();null==i&&(i=s-o-(r-n)),this.emitter.emit("did-change-decoration-range",{start:n,end:r,screenDelta:i,type:e})}removeDecoration(e){if(null==e)return;const t=e.marker;let i;this.decorationsById.delete(e.id),i=this.decorationUpdatedSubscriptions.get(e.id),void 0!==i&&i.dispose(),i=this.decorationDestroyedSubscriptions.get(e.id),void 0!==i&&i.dispose(),this.decorationUpdatedSubscriptions.delete(e.id),this.decorationDestroyedSubscriptions.delete(e.id);const n=this.decorationsByMarkerId.get(t.id);if(void 0===n)return;this.emitDecorationChanges(e.getProperties().type,e);const r=n.indexOf(e);r>-1&&(n.splice(r,1),this.emitter.emit("did-remove-decoration",{marker:t,decoration:e}),0===n.length&&this.removedAllMarkerDecorations(t))}removeAllDecorationsForMarker(e){if(null==e)return;const t=this.decorationsByMarkerId.get(e.id);if(void 0!==t){for(let i=0,n=t.length;n>i;i++){const n=t[i];this.adapter.editorDestroyed()||this.emitDecorationChanges(n.getProperties().type,n),this.emitter.emit("did-remove-decoration",{marker:e,decoration:n})}this.removedAllMarkerDecorations(e)}}removedAllMarkerDecorations(e){null!=e&&(this.decorationMarkerChangedSubscriptions.get(e.id).dispose(),this.decorationMarkerDestroyedSubscriptions.get(e.id).dispose(),this.decorationsByMarkerId.delete(e.id),this.decorationMarkerChangedSubscriptions.delete(e.id),this.decorationMarkerDestroyedSubscriptions.delete(e.id))}removeAllDecorations(){const e=this.decorationMarkerChangedSubscriptions.values();for(const t of e)t.dispose();const t=this.decorationMarkerDestroyedSubscriptions.values();for(const e of t)e.dispose();const i=this.decorationUpdatedSubscriptions.values();for(const e of i)e.dispose();const n=this.decorationDestroyedSubscriptions.values();for(const e of n)e.dispose();const r=this.decorationsById.values();for(const e of r)e.destroy();this.decorationsById.clear(),this.decorationsByMarkerId.clear(),this.decorationMarkerChangedSubscriptions.clear(),this.decorationMarkerDestroyedSubscriptions.clear(),this.decorationUpdatedSubscriptions.clear(),this.decorationDestroyedSubscriptions.clear()}}class cr{constructor(e){this.textEditor=e,this.textEditorElement=atom.views.getView(this.textEditor)}enableCache(){this.useCache=!0}clearCache(){this.useCache=!1,delete this.heightCache,delete this.scrollTopCache,delete this.scrollLeftCache,delete this.maxScrollTopCache}onDidChangeScrollTop(e){return this.textEditorElement.onDidChangeScrollTop(e)}onDidChangeScrollLeft(e){return this.textEditorElement.onDidChangeScrollLeft(e)}getHeight(){return this.editorDestroyed()?0:this.useCache?(this.heightCache||(this.heightCache=this.textEditorElement.getHeight()),this.heightCache):this.textEditorElement.getHeight()}getScrollTop(){return this.editorDestroyed()?0:this.useCache?(this.scrollTopCache||(this.scrollTopCache=this.computeScrollTop()),this.scrollTopCache):this.computeScrollTop()}computeScrollTop(){if(this.editorDestroyed())return 0;const e=this.textEditorElement.getScrollTop(),t=this.textEditor.getLineHeightInPixels();let i=this.textEditorElement.getFirstVisibleScreenRow();if(Number.isNaN(i))return 0;let n=this.textEditorElement.pixelPositionForScreenPosition([i,0]).top;return n>e&&(i-=1,n=this.textEditorElement.pixelPositionForScreenPosition([i,0]).top),i*t+Math.min(e-n,t)}setScrollTop(e){this.editorDestroyed()||this.textEditorElement.setScrollTop(e)}getScrollLeft(){return this.editorDestroyed()?0:this.useCache?(this.scrollLeftCache||(this.scrollLeftCache=this.textEditorElement.getScrollLeft()),this.scrollLeftCache):this.textEditorElement.getScrollLeft()}getMaxScrollTop(){if(this.editorDestroyed())return 0;if(null!=this.maxScrollTopCache&&this.useCache)return this.maxScrollTopCache;let e;if(this.textEditorElement.getMaxScrollTop){if(e=this.textEditorElement.getMaxScrollTop(),parseFloat(atom.getVersion())>=1.13&&this.scrollPastEnd){const t=this.textEditor.getLineHeightInPixels();e-=this.getHeight()-3*t}}else if(e=this.textEditorElement.getScrollHeight()-this.getHeight(),this.scrollPastEnd){const t=this.textEditor.getLineHeightInPixels();e-=this.getHeight()-3*t}return this.useCache&&(this.maxScrollTopCache=e),e}editorDestroyed(){return!this.textEditor||this.textEditor.isDestroyed()||!this.textEditorElement.component||!this.textEditorElement.getModel()||!this.textEditorElement.parentNode}}let hr=1;class dr{static initClass(){return yt(this,lr),this}constructor(e={}){if(!e.textEditor)throw Error("Cannot create a minimap without an editor");this.textEditor=e.textEditor,this.editorElement=void 0,this.standAlone=e.standAlone,this.width=e.width,this.height=e.height,this.id=hr++,this.emitter=new ti.Emitter,this.subscriptions=new ti.CompositeDisposable,this.adapter=null,this.charHeight=null,this.configCharHeight=null,this.charWidth=null,this.configCharWidth=null,this.interline=null,this.configInterline=null,this.devicePixelRatioRounding=null,this.configDevicePixelRatioRounding=null,this.redrawDelay=0,this.destroyed=!1,this.scrollPastEnd=!1,this.pendingChangeEvents=[],this.flushChangesTimer=null,this.initializeDecorations(),null!=atom.views.getView(this.textEditor).getScrollTop?this.adapter=new cr(this.textEditor):(atom.notifications.addWarning("LegacyAdapter of Minimap is deprecated and will be removed in the next major version. Please upgrade Atom to the latest version."),this.adapter=new sr(this.textEditor)),this.scrollTop=0;const t=this.subscriptions;let i=this.subscribeToConfig();t.add(i),t.add(this.textEditor.onDidChangeGrammar((()=>{t.remove(i),i.dispose(),i=this.subscribeToConfig(),t.add(i)}))),t.add(this.adapter.onDidChangeScrollTop((()=>{this.standAlone||this.ignoreTextEditorScroll||this.inChangeScrollTop||(this.inChangeScrollTop=!0,this.updateScrollTop(),this.emitter.emit("did-change-scroll-top",this),this.inChangeScrollTop=!1),this.ignoreTextEditorScroll&&(this.ignoreTextEditorScroll=!1)}))),t.add(this.adapter.onDidChangeScrollLeft((()=>{this.standAlone||this.emitter.emit("did-change-scroll-left",this)}))),t.add(this.textEditor.onDidChange((e=>{this.scheduleChanges(e)}))),t.add(this.textEditor.onDidDestroy((()=>{this.destroy()}))),t.add(this.textEditor.onDidTokenize((()=>{this.emitter.emit("did-change-config")})))}destroy(){this.destroyed||(clearTimeout(this.flushChangesTimer),this.flushChangesTimer=null,this.pendingChangeEvents=[],this.removeAllDecorations(),this.subscriptions.dispose(),this.subscriptions=null,this.textEditor=null,this.emitter.emit("did-destroy"),this.emitter.dispose(),this.destroyed=!0)}isDestroyed(){return this.destroyed}scheduleChanges(e){this.pendingChangeEvents=this.pendingChangeEvents.concat(e),this.redrawDelay||this.requestFlushChanges(),this.flushChangesTimer||(this.flushChangesTimer=setTimeout((()=>{this.requestFlushChanges()}),this.redrawDelay))}flushChanges(){clearTimeout(this.flushChangesTimer),this.flushChangesTimer=null,this.emitChanges(this.pendingChangeEvents),this.pendingChangeEvents=[]}requestFlushChanges(){this.requestedFlushChanges||(this.requestedFlushChanges=requestAnimationFrame((()=>{this.flushChanges(),this.requestedFlushChanges&&(cancelAnimationFrame(this.requestedFlushChanges),this.requestedFlushChanges=null)})))}onDidChange(e){return this.emitter.on("did-change",e)}onDidChangeConfig(e){return this.emitter.on("did-change-config",e)}onDidChangeScrollTop(e){return this.emitter.on("did-change-scroll-top",e)}onDidChangeScrollLeft(e){return this.emitter.on("did-change-scroll-left",e)}onDidChangeStandAlone(e){return this.emitter.on("did-change-stand-alone",e)}onDidDestroy(e){return this.emitter.on("did-destroy",e)}subscribeToConfig(){const e=new ti.CompositeDisposable,t={scope:this.textEditor.getRootScopeDescriptor()};return e.add(atom.config.observe("editor.scrollPastEnd",t,(e=>{this.scrollPastEnd=e,this.adapter.scrollPastEnd=this.scrollPastEnd,this.emitter.emit("did-change-config")}))),e.add(atom.config.observe("minimap.charHeight",t,(e=>{this.configCharHeight=e,this.updateScrollTop(),this.emitter.emit("did-change-config")}))),e.add(atom.config.observe("minimap.charWidth",t,(e=>{this.configCharWidth=e,this.updateScrollTop(),this.emitter.emit("did-change-config")}))),e.add(atom.config.observe("minimap.interline",t,(e=>{this.configInterline=e,this.updateScrollTop(),this.emitter.emit("did-change-config")}))),e.add(atom.config.observe("minimap.independentMinimapScroll",t,(e=>{this.independentMinimapScroll=e,this.updateScrollTop()}))),e.add(atom.config.observe("minimap.scrollSensitivity",t,(e=>{this.scrollSensitivity=e}))),e.add(atom.config.observe("minimap.redrawDelay",t,(e=>{this.redrawDelay=e}))),e.add(atom.config.observe("minimap.devicePixelRatioRounding",t,(e=>{this.configDevicePixelRatioRounding=e,this.updateScrollTop(),this.emitter.emit("did-change-config")}))),e}isStandAlone(){return this.standAlone}setStandAlone(e){e!==this.standAlone&&(this.standAlone=e,this.emitter.emit("did-change-stand-alone",this))}getTextEditor(){return this.textEditor}getTextEditorElement(){return this.editorElement||(this.editorElement=atom.views.getView(this.getTextEditor())),this.editorElement}getTextEditorScaledHeight(){return this.adapter.getHeight()*this.getVerticalScaleFactor()}getTextEditorScaledScrollTop(){return this.adapter.getScrollTop()*this.getVerticalScaleFactor()}getTextEditorScaledScrollLeft(){return this.adapter.getScrollLeft()*this.getHorizontalScaleFactor()}getTextEditorMaxScrollTop(){return this.adapter.getMaxScrollTop()}getTextEditorScrollTop(){return this.adapter.getScrollTop()}setTextEditorScrollTop(e,t=!1){this.ignoreTextEditorScroll=t,this.adapter.setScrollTop(e)}getTextEditorScrollLeft(){return this.adapter.getScrollLeft()}getTextEditorHeight(){return this.adapter.getHeight()}getTextEditorScrollRatio(){return this.adapter.getScrollTop()/(this.getTextEditorMaxScrollTop()||1)}getCapedTextEditorScrollRatio(){return Math.min(1,this.getTextEditorScrollRatio())}getHeight(){return this.textEditor.getScreenLineCount()*this.getLineHeight()}getWidth(){return this.textEditor.getMaxScreenLineLength()*this.getCharWidth()}getVisibleHeight(){return Math.min(this.getScreenHeight(),this.getHeight())}getScreenHeight(){return this.isStandAlone()?null!=this.height?this.height:this.getHeight():this.adapter.getHeight()}getVisibleWidth(){return Math.min(this.getScreenWidth(),this.getWidth())}getScreenWidth(){return this.isStandAlone()&&null!=this.width?this.width:this.getWidth()}setScreenHeightAndWidth(e,t){this.width===t&&this.height===e||(this.height=e,this.width=t,this.updateScrollTop())}getVerticalScaleFactor(){return this.getLineHeight()/this.textEditor.getLineHeightInPixels()}getHorizontalScaleFactor(){return this.getCharWidth()/this.textEditor.getDefaultCharWidth()}getLineHeight(){return this.getCharHeight()+this.getInterline()}getCharWidth(){return null!=this.charWidth?this.charWidth:this.configCharWidth}setCharWidth(e){this.charWidth=Math.floor(e),this.emitter.emit("did-change-config")}getCharHeight(){return null!=this.charHeight?this.charHeight:this.configCharHeight}setCharHeight(e){this.charHeight=Math.floor(e),this.emitter.emit("did-change-config")}getInterline(){return null!=this.interline?this.interline:this.configInterline}setInterline(e){this.interline=Math.floor(e),this.emitter.emit("did-change-config")}getDevicePixelRatioRounding(){return null!=this.devicePixelRatioRounding?this.devicePixelRatioRounding:this.configDevicePixelRatioRounding}setDevicePixelRatioRounding(e){this.devicePixelRatioRounding=e,this.emitter.emit("did-change-config")}getDevicePixelRatio(){return this.getDevicePixelRatioRounding()?Math.floor(devicePixelRatio):devicePixelRatio}getFirstVisibleScreenRow(){return Math.floor(this.getScrollTop()/this.getLineHeight())}getLastVisibleScreenRow(){return Math.ceil((this.getScrollTop()+this.getScreenHeight())/this.getLineHeight())}scrollIndependentlyOnMouseWheel(){return this.independentMinimapScroll}getScrollTop(){return this.standAlone||this.independentMinimapScroll?this.scrollTop:this.getScrollTopFromEditor()}setScrollTop(e){this.scrollTop=Math.max(0,Math.min(this.getMaxScrollTop(),e)),(this.standAlone||this.independentMinimapScroll)&&this.emitter.emit("did-change-scroll-top",this)}getScrollRatio(){return this.getScrollTop()/this.getMaxScrollTop()}updateScrollTop(){if(this.independentMinimapScroll){try{this.setScrollTop(this.getScrollTopFromEditor())}catch(e){}this.emitter.emit("did-change-scroll-top",this)}}getScrollTopFromEditor(){return Math.abs(this.getCapedTextEditorScrollRatio()*this.getMaxScrollTop())}getMaxScrollTop(){return Math.max(0,this.getHeight()-this.getScreenHeight())}canScroll(){return this.getMaxScrollTop()>0}onMouseWheel(e){if(this.scrollIndependentlyOnMouseWheel()){if(e.stopPropagation(),!this.canScroll())return;const{wheelDeltaY:t}=e,i=this.getScrollTop()-Math.round(t*this.scrollSensitivity);e.preventDefault(),this.setScrollTop(i)}}getMarker(e){return this.textEditor.getMarker(e)}findMarkers(e){try{return this.textEditor.findMarkers(e)}catch(e){return[]}}markBufferRange(e){return this.textEditor.markBufferRange(e)}emitChanges(e){this.emitter.emit("did-change",e)}enableCache(){this.adapter.enableCache()}clearCache(){this.adapter.clearCache()}editorDestroyed(){this.adapter.editorDestroyed()}}dr.initClass();const ur={plugins:{type:"object",properties:{}},autoToggle:{title:"Show Minimap On Atom Start",type:"boolean",default:!0,order:1},displayMinimapOnLeft:{type:"boolean",default:!1,order:2},displayCodeHighlights:{type:"boolean",default:!0,description:"Toggles the render of the buffer tokens in the minimap.",order:3},displayPluginsControls:{type:"boolean",default:!0,description:"You need to restart Atom for this setting to be effective.",order:4},minimapScrollIndicator:{type:"boolean",default:!0,description:"Toggles the display of a side line showing which part of the buffer is currently displayed by the minimap. This side line will only appear if the minimap is taller than the editor view height.",order:5},adjustMinimapWidthToSoftWrap:{type:"boolean",default:!0,description:"If this option is enabled and Soft Wrap is checked then the Minimap max width is set to the Preferred Line Length value.",order:6},adjustMinimapWidthOnlyIfSmaller:{type:"boolean",default:!0,description:"If this option and `adjustMinimapWidthToSoftWrap` are enabled the minimap width will never go past the limit sets by CSS. On the other hand, when disabled the minimap will expand to honor the preferred line width.",order:7},ignoreWhitespacesInTokens:{type:"boolean",default:!1,description:"When enabled, text editor tokens are rendered as plain blocks, with no regards to the whitespaces they contains.",order:8},charWidth:{type:"number",default:1,minimum:.5,order:9},charHeight:{type:"number",default:2,minimum:.5,order:10},interline:{type:"number",default:1,minimum:0,description:"The space between lines in the minimap in pixels.",order:11},textOpacity:{type:"number",default:.6,minimum:0,maximum:1,description:"The opacity used to render the line's text in the minimap.",order:12},moveCursorOnMinimapClick:{type:"boolean",default:!1,description:"Moves the cursor to the beginning of the target line when clicking on the minimap",order:13},independentMinimapScroll:{type:"boolean",title:"Independent Minimap Scroll On Mouse Wheel Events",default:!1,description:"When enabled, using the mouse wheel over the Minimap will make it scroll independently of the text editor. The Minimap will still sync with the editor whenever the editor is scrolled, but it will no longer relay the mouse wheel events to the editor.",order:14},scrollSensitivity:{type:"number",default:.5,description:"The scrolling speed when the `Independent Minimap Scroll On Mouse Wheel Events` setting is enabled.",order:15},smoothScrolling:{type:"boolean",default:!1,description:"Whether to offset the minimap canvas when scrolling to keep the scroll smooth. When `true` the minimap canvas will be offseted, resulting in a smoother scroll, but with the side-effect of a blurry minimap when the canvas is placed between pixels. When `false` the canvas will always stay at the same position, and will never look blurry, but the scroll will appear more jagged.",order:16},createPluginInDevMode:{type:"boolean",default:!1,order:17},absoluteMode:{type:"boolean",default:!1,description:"When enabled the text editor content will be able to flow below the minimap.",order:18},adjustAbsoluteModeHeight:{type:"boolean",default:!1,description:"When enabled and `Absolute Mode` is also enabled, the minimap height will be adjusted to only take the space required by the text editor content, leaving the space below triggering mouse events on the text editor. **Be aware this can have some impact on performances as the minimap canvases will be resized every time a change in the editor make its height change.**",order:19},redrawDelay:{type:"number",default:400,minimum:0,maximum:2e3,description:"Controls how often (in ms) the minimap should redraw itself after changing the text editor's contents. Setting this to 100ms or higher could dramatically improve editor responsiveness when working with large files. A value of 0 will cause the minimap to redraw itself immediately on each change.",order:20},devicePixelRatioRounding:{type:"boolean",default:!0,description:"Toggles the rounding of the devicePixelRatio in the minimap.",order:21},useHardwareAcceleration:{type:"boolean",default:!0,order:22},scrollAnimation:{type:"boolean",default:!1,description:"Enables animations when scrolling by clicking on the minimap.",order:23},scrollAnimationDuration:{type:"integer",default:300,description:"The duration of scrolling animations when clicking on the minimap.",order:24},maxTokensInOneLine:{type:"integer",default:160,description:"The maximum number of tokens that are rendered for each line.",order:25}},pr={},mr={},gr={};class fr{constructor(){this.domStylesCache=new Map,this.dummyNode=void 0,this.targetNode=void 0}retrieveStyleFromDom(e,t,i,n){if(!e.length)return"";const r=e.join(" ");let s=this.domStylesCache.get(r);if(void 0!==s){if(n){const e=s[t];if(void 0!==e)return e}}else s={};this.ensureDummyNodeExistence(i);let o=this.dummyNode;for(let t=0,i=e.length;i>t;t++){const i=e[t],n=document.createElement("span");n.className=i.replace(vr," "),o.appendChild(n),o=n}const a=window.getComputedStyle(o);let l=a.getPropertyValue(t);const c=a.getPropertyValue("-webkit-filter");return c.indexOf("hue-rotate")>-1&&(l=function(e,t){const i=e.match(/rgb(a?)\((\d+), (\d+), (\d+)(, (\d+(\.\d+)?))?\)/);let[,,n,r,s,,o]=i,[,a]=t.match(/hue-rotate\((\d+)deg\)/);return[n,r,s,o,a]=[n,r,s,o,a].map(Number),[n,r,s]=((e,t,i,n)=>{function r(e){return Math.ceil(Math.max(0,Math.min(255,e)))}const s=[1,0,0,0,1,0,0,0,1],o=.2126,a=.7152,l=.0722,c=Math.cos(n*Math.PI/180),h=Math.sin(n*Math.PI/180);return s[0]=o+.7874*c-o*h,s[1]=a-a*c-a*h,s[2]=l-l*c+.9278*h,s[3]=o-o*c+.143*h,s[4]=a+(1-a)*c+.14*h,s[5]=l-l*c-.283*h,s[6]=o-o*c-.7874*h,s[7]=a-a*c+a*h,s[8]=l+.9278*c+l*h,[r(s[0]*e+s[1]*t+s[2]*i),r(s[3]*e+s[4]*t+s[5]*i),r(s[6]*e+s[7]*t+s[8]*i)]})(n,r,s,a),isNaN(o)?`rgb(${n}, ${r}, ${s})`:`rgba(${n}, ${r}, ${s}, ${o})`}(l,c)),""!==l&&(s[t]=l,this.domStylesCache.set(r,s)),this.dummyNode.innerHTML="",l}ensureDummyNodeExistence(e){this.targetNode===e&&void 0!==this.dummyNode||(this.dummyNode=document.createElement("span"),this.dummyNode.style.visibility="hidden",e.appendChild(this.dummyNode),this.targetNode=e)}invalidateDOMStylesCache(){this.domStylesCache.clear()}}const vr=/\.+/g;let yr=!1,br=!1,Sr=null,wr=null,xr=null;const Er=new ti.Emitter;exports.domStylesReader=null;const Cr={minimapViewProvider:Nt,getConfigSchema:jt,onDidActivate:Bt,onDidDeactivate:qt,onDidCreateMinimap:zt,onDidAddPlugin:Ut,onDidRemovePlugin:Vt,onDidActivatePlugin:$t,onDidDeactivatePlugin:Qt,onDidChangePluginOrder:Kt,minimapClass:Zt,minimapForEditorElement:Gt,minimapForEditor:Yt,standAloneMinimapForEditor:Xt,getActiveMinimap:Jt,observeMinimaps:ei,registerPlugin:Dt,unregisterPlugin:At,togglePluginActivation:Lt,deactivateAllPlugins:Ot,activatePlugin:Rt,deactivatePlugin:Pt,getPluginsOrder:Ht};exports.Minimap=dr,exports.activate=()=>{yr||(xr=atom.commands.add("atom-workspace",{"minimap:toggle"(){Ft()},async"minimap:generate-coffee-plugin"(){await Wt("coffee")},async"minimap:generate-javascript-plugin"(){await Wt("javascript")},async"minimap:generate-babel-plugin"(){await Wt("babel")}}),Sr=new Map,exports.domStylesReader=new fr,wr=new ti.CompositeDisposable,yr=!0,atom.config.get("minimap.autoToggle")&&Ft())},exports.activatePlugin=Rt,exports.commonjsGlobal=oi,exports.config=ur,exports.createCommonjsModule=i,exports.deactivate=()=>{yr&&(Ot(),Sr&&Sr.forEach(((e,t)=>{e.destroy(),Sr.delete(t)})),wr.dispose(),wr=null,xr.dispose(),xr=null,Sr=void 0,exports.domStylesReader.invalidateDOMStylesCache(),br=!1,yr=!1)},exports.deactivateAllPlugins=Ot,exports.deactivatePlugin=Pt,exports.element=bt,exports.emitter=Er,exports.getActiveMinimap=Jt,exports.getConfigSchema=jt,exports.getPluginsOrder=Ht,exports.minimapClass=Zt,exports.minimapForEditor=Yt,exports.minimapForEditorElement=Gt,exports.minimapViewProvider=Nt,exports.observeMinimaps=ei,exports.onDidActivate=Bt,exports.onDidActivatePlugin=$t,exports.onDidAddPlugin=Ut,exports.onDidChangePluginOrder=Kt,exports.onDidCreateMinimap=zt,exports.onDidDeactivate=qt,exports.onDidDeactivatePlugin=Qt,exports.onDidRemovePlugin=Vt,exports.plugins=pr,exports.provideMinimapServiceV1=()=>Cr,exports.registerPlugin=Dt,exports.standAloneMinimapForEditor=Xt,exports.toggle=Ft,exports.togglePluginActivation=Lt,exports.underscorePlus=Kn,exports.unregisterPlugin=At;
//# sourceMappingURL=main-a2a9f2dc.js.map
